<!DOCTYPE html>
<html>
<head>
    <title>BenchSight Schema Validation Report</title>
    <style>
        * { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0f172a; color: #e2e8f0; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; }
        h1 { color: #60a5fa; margin-bottom: 10px; }
        .timestamp { color: #94a3b8; margin-bottom: 30px; }
        
        .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
        .card { background: #1e293b; padding: 20px; border-radius: 8px; text-align: center; }
        .card h2 { font-size: 2.5rem; margin-bottom: 5px; }
        .card.pass h2 { color: #22c55e; }
        .card.fail h2 { color: #ef4444; }
        .card.skip h2 { color: #f59e0b; }
        .card.rows h2 { color: #60a5fa; }
        .card p { color: #94a3b8; }
        
        table { width: 100%; border-collapse: collapse; background: #1e293b; border-radius: 8px; overflow: hidden; }
        th { background: #334155; padding: 12px; text-align: left; font-weight: 600; }
        td { padding: 12px; border-top: 1px solid #334155; }
        tr:hover { background: #334155; }
        
        .status { padding: 4px 12px; border-radius: 4px; font-weight: 600; font-size: 0.85rem; }
        .status.pass { background: #166534; color: #86efac; }
        .status.fail { background: #991b1b; color: #fca5a5; }
        .status.skip { background: #92400e; color: #fcd34d; }
        
        .extra { color: #fca5a5; font-size: 0.85rem; }
        .missing { color: #94a3b8; font-size: 0.85rem; }
        
        .workflow { background: #1e293b; padding: 20px; border-radius: 8px; margin-top: 30px; }
        .workflow h3 { color: #60a5fa; margin-bottom: 15px; }
        .workflow pre { background: #0f172a; padding: 15px; border-radius: 4px; overflow-x: auto; }
        .workflow code { color: #86efac; }
    </style>
</head>
<body>

<!-- ================================================================== -->
<!-- CHANGELOG - MUST BE UPDATED WITH EVERY MODIFICATION -->
<!-- ================================================================== -->
<!--
CHANGELOG:
---------------------------------------------------------------------------
2026-01-06 v8.0.5:
  - CRITICAL FIX: Restored 4 missing src/advanced/ modules:
    * create_additional_tables.py
    * enhance_all_stats.py
    * final_stats_enhancement.py
    * extended_tables.py
  - Created fact_events_player.csv (7,476 rows)
  - Extended tables now run: +15 tables created
  - Table count: 131 (54 dim, 73 fact, 3 QA, 1 other)
  - Added comprehensive code audit documentation
  - Fixed column name mismatches (Type -> event_type)

2026-01-06 v8.0.4:
  - CRITICAL: Recovered 72 missing tables from v7 backup
  - Table count restored from 53 to 130
  - Created 4 new outcome dimension tables
  - Regenerated ERD with all tables
  - Added table integrity tests

2026-01-05 v8.0.0:
  - Major schema expansion: 96 -> 111 tables planned
  - Added 317 player metrics
  - Created comprehensive foreign key relationships
  - Added QA validation tables

RULES FOR UPDATING THIS CHANGELOG:
1. ALWAYS add entry BEFORE making changes
2. Include: date, version, what changed, table counts
3. Never delete old entries
4. Be specific about what was added/changed/removed
---------------------------------------------------------------------------
-->

    <div class="container">
        <h1>üèí BenchSight Schema Validation Report</h1>
        <p class="timestamp">Generated: January 7, 2026-12-28 16:25:27</p>
        
        <div class="summary">
            <div class="card pass">
                <h2>48</h2>
                <p>Passed</p>
            </div>
            <div class="card fail">
                <h2>0</h2>
                <p>Failed</p>
            </div>
            <div class="card skip">
                <h2>1</h2>
                <p>Skipped</p>
            </div>
            <div class="card rows">
                <h2>59,875</h2>
                <p>Total Rows</p>
            </div>
        </div>
        
        <table>
            <thead>
                <tr>
                    <th>Table</th>
                    <th>Status</th>
                    <th>Rows</th>
                    <th>CSV Cols</th>
                    <th>Schema Cols</th>
                    <th>Details</th>
                </tr>
            </thead>
            <tbody>

                <tr>
                    <td><strong>dim_danger_zone</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>3</td>
                    <td>9</td>
                    <td>9</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_event_detail</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>57</td>
                    <td>14</td>
                    <td>14</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_event_detail_2</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>143</td>
                    <td>6</td>
                    <td>6</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_event_type</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>20</td>
                    <td>19</td>
                    <td>19</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_game_players_tracking</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>27</td>
                    <td>10</td>
                    <td>10</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_league</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>2</td>
                    <td>2</td>
                    <td>2</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_net_location</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>15</td>
                    <td>14</td>
                    <td>14</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_pass_type</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>19</td>
                    <td>7</td>
                    <td>7</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_period</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>5</td>
                    <td>6</td>
                    <td>6</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_play_detail</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>120</td>
                    <td>10</td>
                    <td>10</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_player</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>337</td>
                    <td>27</td>
                    <td>27</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_player_role</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>7</td>
                    <td>5</td>
                    <td>5</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_playerurlref</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>548</td>
                    <td>3</td>
                    <td>3</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_position</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>9</td>
                    <td>6</td>
                    <td>6</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_randomnames</strong></td>
                    <td><span class="status skip">SKIP</span></td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>Not in schema</td>
                </tr>

                <tr>
                    <td><strong>dim_rinkboxcoord</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>50</td>
                    <td>6</td>
                    <td>10</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_rinkcoordzones</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>202</td>
                    <td>14</td>
                    <td>14</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_schedule</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>562</td>
                    <td>44</td>
                    <td>44</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_season</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>9</td>
                    <td>8</td>
                    <td>8</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_shift_type</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>6</td>
                    <td>4</td>
                    <td>4</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_shot_type</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>14</td>
                    <td>7</td>
                    <td>7</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_situation</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>5</td>
                    <td>7</td>
                    <td>7</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_skill_tier</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>5</td>
                    <td>5</td>
                    <td>5</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_stat</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>104</td>
                    <td>17</td>
                    <td>17</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_strength</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>9</td>
                    <td>7</td>
                    <td>7</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_team</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>26</td>
                    <td>14</td>
                    <td>14</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_time_bucket</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>4</td>
                    <td>5</td>
                    <td>5</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_turnover_type</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>21</td>
                    <td>9</td>
                    <td>9</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_venue</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>2</td>
                    <td>4</td>
                    <td>4</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_video</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>10</td>
                    <td>12</td>
                    <td>12</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>dim_zone</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>3</td>
                    <td>5</td>
                    <td>5</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_box_score</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>27</td>
                    <td>38</td>
                    <td>39</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_box_score_tracking</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>27</td>
                    <td>80</td>
                    <td>80</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_draft</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>160</td>
                    <td>14</td>
                    <td>14</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_event_coordinates</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>0</td>
                    <td>7</td>
                    <td>7</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_event_players_tracking</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>3,132</td>
                    <td>17</td>
                    <td>17</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_events</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>1,641</td>
                    <td>13</td>
                    <td>13</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_events_long</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>24,089</td>
                    <td>15</td>
                    <td>15</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_event_players</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>7,840</td>
                    <td>25</td>
                    <td>28</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_gameroster</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>14,473</td>
                    <td>19</td>
                    <td>26</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_leadership</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>28</td>
                    <td>9</td>
                    <td>9</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_linked_events_tracking</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>229</td>
                    <td>9</td>
                    <td>9</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_playergames</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>3,010</td>
                    <td>19</td>
                    <td>19</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_plays_tracking</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>4</td>
                    <td>7</td>
                    <td>7</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_registration</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>191</td>
                    <td>18</td>
                    <td>18</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_sequences_tracking</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>4</td>
                    <td>8</td>
                    <td>8</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_shift_players_tracking</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>1,136</td>
                    <td>16</td>
                    <td>16</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_shifts</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>770</td>
                    <td>19</td>
                    <td>19</td>
                    <td>Matches schema</td>
                </tr>

                <tr>
                    <td><strong>fact_shifts</strong></td>
                    <td><span class="status pass">PASS</span></td>
                    <td>770</td>
                    <td>34</td>
                    <td>34</td>
                    <td>Matches schema</td>
                </tr>

            </tbody>
        </table>
        
        <div class="workflow">
            <h3>Upload Workflow</h3>
            <pre><code># 1. Run tests (all must pass)
pytest tests/test_schema_compliance.py -v

# 2. Preview upload
python PRODUCTION_ETL.py --dry-run

# 3. Upload
python PRODUCTION_ETL.py</code></pre>
        </div>
        
        <div class="workflow">
            <h3>Schema Source of Truth</h3>
            <p style="margin-bottom: 10px; color: #94a3b8;">File: <code>config/supabase_schema.json</code></p>
            <p style="color: #94a3b8;">Tables: 50 | Last Updated: 2025-12-28</p>
        </div>
    </div>
</body>
</html>
