<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BenchSight - All Diagrams</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #1e40af;
            --success: #10b981;
            --dark: #1f2937;
            --light: #f3f4f6;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--light);
            padding: 1rem;
            line-height: 1.6;
            color: var(--dark);
        }
        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            text-align: center;
        }
        .header h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .nav {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        .nav a {
            color: var(--primary);
            text-decoration: none;
            padding: 0.5rem 1rem;
            background: white;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        .nav a:hover { background: var(--light); border-color: var(--primary); }
        .section {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .section h2 {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        .diagram-container {
            background: #fafafa;
            border-radius: 4px;
            padding: 1rem;
            overflow: auto;
            margin-top: 1rem;
        }
        .mermaid { font-size: 12px; }
        .stats {
            display: flex;
            gap: 2rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        .stat {
            background: #eff6ff;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            text-align: center;
        }
        .stat-value { font-size: 1.5rem; font-weight: bold; color: var(--primary); }
        .stat-label { font-size: 0.875rem; color: #6b7280; }
    </style>
</head>
<body>

<!-- ================================================================== -->
<!-- CHANGELOG - MUST BE UPDATED WITH EVERY MODIFICATION -->
<!-- ================================================================== -->
<!--
CHANGELOG:
---------------------------------------------------------------------------
2026-01-06 v8.0.5:
  - CRITICAL FIX: Restored 4 missing src/advanced/ modules:
    * create_additional_tables.py
    * enhance_all_stats.py
    * final_stats_enhancement.py
    * extended_tables.py
  - Created fact_events_player.csv (7,476 rows)
  - Extended tables now run: +15 tables created
  - Table count: 131 (54 dim, 73 fact, 3 QA, 1 other)
  - Added comprehensive code audit documentation
  - Fixed column name mismatches (Type -> event_type)

2026-01-06 v8.0.4:
  - CRITICAL: Recovered 72 missing tables from v7 backup
  - Table count restored from 53 to 130
  - Created 4 new outcome dimension tables
  - Regenerated ERD with all tables
  - Added table integrity tests

2026-01-05 v8.0.0:
  - Major schema expansion: 96 -> 111 tables planned
  - Added 317 player metrics
  - Created comprehensive foreign key relationships
  - Added QA validation tables

RULES FOR UPDATING THIS CHANGELOG:
1. ALWAYS add entry BEFORE making changes
2. Include: date, version, what changed, table counts
3. Never delete old entries
4. Be specific about what was added/changed/removed
---------------------------------------------------------------------------
-->

    <div class="header">
        <h1>üìê BenchSight Diagrams</h1>
        <p>Architecture, Data Flow, and Schema Visualization</p>
    </div>

    <div class="nav">
        <a href="../index.html">‚Üê Documentation Hub</a>
        <a href="ERD_VIEWER.html">Full ERD</a>
        <a href="../STAT_CALCS.html">Stats & Calculations</a>
    </div>

    <div class="stats">
        <div class="stat">
            <div class="stat-value">128</div>
            <div class="stat-label">Total Tables</div>
        </div>
        <div class="stat">
            <div class="stat-value">54</div>
            <div class="stat-label">Dimensions</div>
        </div>
        <div class="stat">
            <div class="stat-value">71</div>
            <div class="stat-label">Fact Tables</div>
        </div>
    </div>

    <div class="section">
        <h2>üîÑ ETL Data Flow</h2>
        <div class="diagram-container">
            <pre class="mermaid">
flowchart LR
    subgraph Sources["üì• Data Sources"]
        BLB[BLB_Tables.xlsx]
        TRACK[Game Tracking Files]
    end
    
    subgraph ETL["‚öôÔ∏è ETL Pipeline"]
        P1[Load BLB Tables]
        P2[Load Tracking Data]
        P3[Create Reference Tables]
        P4[Create Derived Tables]
        P5[Enhance & Validate]
    end
    
    subgraph Output["üì§ Output"]
        DIM[(29 Dimension Tables)]
        FACT[(24 Fact Tables)]
    end
    
    BLB --> P1
    TRACK --> P2
    P1 --> P2
    P2 --> P3
    P3 --> P4
    P4 --> P5
    P5 --> DIM
    P5 --> FACT
            </pre>
        </div>
    </div>

    <div class="section">
        <h2>‚≠ê Star Schema Overview</h2>
        <div class="diagram-container">
            <pre class="mermaid">
erDiagram
    fact_events ||--o{ dim_player : "player_id"
    fact_events ||--o{ dim_team : "team_id"
    fact_events ||--o{ dim_schedule : "game_id"
    fact_events ||--o{ dim_event_type : "event_type_id"
    fact_events ||--o{ dim_period : "period_id"
    
    fact_gameroster ||--o{ dim_player : "player_id"
    fact_gameroster ||--o{ dim_team : "team_id"
    fact_gameroster ||--o{ dim_schedule : "game_id"
    
    fact_shifts ||--o{ dim_player : "player_id"
    fact_shifts ||--o{ dim_schedule : "game_id"
    
    dim_player {
        string player_id PK
        string player_full_name
        string position
    }
    
    dim_team {
        string team_id PK
        string team_name
    }
    
    dim_schedule {
        int game_id PK
        date game_date
        string home_team
        string away_team
    }
    
    fact_events {
        string event_id PK
        int game_id FK
        string player_id FK
        string event_type
    }
            </pre>
        </div>
    </div>

    <div class="section">
        <h2>üìä Table Categories</h2>
        <div class="diagram-container">
            <pre class="mermaid">
pie title Tables by Category
    "Dimensions (29)" : 29
    "Fact Tables (24)" : 24
            </pre>
        </div>
    </div>

    <div class="section">
        <h2>üîó Key Relationships</h2>
        <div class="diagram-container">
            <pre class="mermaid">
graph TD
    subgraph Core["Core Dimensions"]
        P[dim_player]
        T[dim_team]
        S[dim_schedule]
        SE[dim_season]
    end
    
    subgraph Events["Event Facts"]
        E[fact_events]
        ET[fact_event_players]
        SEQ[fact_sequences]
        PL[fact_plays]
    end
    
    subgraph Shifts["Shift Facts"]
        SH[fact_shifts]
        SHT[fact_shifts]
        SP[fact_shift_players]
    end
    
    subgraph Rosters["Roster Facts"]
        GR[fact_gameroster]
        PGP[fact_player_game_position]
    end
    
    P --> E
    P --> ET
    P --> GR
    P --> SH
    
    T --> E
    T --> GR
    
    S --> E
    S --> GR
    S --> SH
    
    E --> SEQ
    E --> PL
    SH --> SHT
    SHT --> SP
            </pre>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: { curve: 'basis' }
        });
    </script>

    <footer style="text-align: center; padding: 2rem; color: #6b7280; font-size: 0.875rem;">
        BenchSight v13.18.4 | 128 Tables
    </footer>
</body>
</html>
