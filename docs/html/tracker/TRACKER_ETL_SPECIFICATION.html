<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BenchSight Tracker - ETL Input Specification - BenchSight</title>
<style>
:root {
  --bg: #0d1117;
  --surface: #161b22;
  --border: #30363d;
  --text: #c9d1d9;
  --muted: #8b949e;
  --accent: #58a6ff;
  --accent2: #3fb950;
  --warn: #d29922;
  --danger: #f85149;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
  font-size: 14px;
}
.container { max-width: 900px; margin: 0 auto; padding: 20px 40px; }
header {
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  padding: 15px 0;
}
header .container { display: flex; justify-content: space-between; align-items: center; }
header h1 {
  font-size: 18px;
  color: var(--accent);
}
header nav a {
  color: var(--muted);
  text-decoration: none;
  margin-left: 15px;
  font-size: 13px;
}
header nav a:hover { color: var(--accent); }
main { padding: 30px 0; }
h1 { font-size: 28px; color: var(--accent); margin-bottom: 20px; }
h2 { font-size: 22px; color: var(--text); margin: 30px 0 15px; padding-bottom: 8px; border-bottom: 1px solid var(--border); }
h3 { font-size: 18px; color: var(--accent2); margin: 25px 0 12px; }
h4 { font-size: 15px; color: var(--text); margin: 20px 0 10px; }
p { margin: 12px 0; color: var(--text); }
ul, ol { margin: 12px 0 12px 25px; }
li { margin: 6px 0; }
code {
  font-family: 'SF Mono', Consolas, monospace;
  background: var(--surface);
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 13px;
  border: 1px solid var(--border);
}
pre {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 15px;
  overflow-x: auto;
  margin: 15px 0;
  font-size: 12px;
}
pre code { background: none; border: none; padding: 0; }
table {
  width: 100%;
  border-collapse: collapse;
  margin: 15px 0;
  font-size: 13px;
}
th, td {
  border: 1px solid var(--border);
  padding: 10px 12px;
  text-align: left;
}
th { background: var(--surface); color: var(--accent); }
tr:nth-child(even) { background: rgba(255,255,255,0.02); }
blockquote {
  border-left: 3px solid var(--accent);
  padding: 10px 15px;
  margin: 15px 0;
  background: rgba(88,166,255,0.1);
  border-radius: 0 6px 6px 0;
}
hr { border: none; border-top: 1px solid var(--border); margin: 30px 0; }
a { color: var(--accent); text-decoration: none; }
a:hover { text-decoration: underline; }
strong { color: var(--text); }
.badge {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
}
.badge-done { background: var(--accent2); color: #000; }
.badge-pending { background: var(--warn); color: #000; }
footer {
  border-top: 1px solid var(--border);
  padding: 20px 0;
  margin-top: 40px;
  text-align: center;
  color: var(--muted);
  font-size: 12px;
}
</style>
</head>
<body>
<header>
  <div class="container">
    <h1>⚡ BenchSight</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="tracker/index.html">Tracker</a>
      <a href="tables.html">Tables</a>
      <a href="diagrams/ERD_VIEWER.html">ERD</a>
    </nav>
  </div>
</header>
<main>
<div class="container">
<h1>BenchSight Tracker - ETL Input Specification</h1>

<strong>Version:</strong> 1.0  
<strong>Date:</strong> 2026-01-07  
<strong>Purpose:</strong> EXACT specification for tracker output that ETL expects
<p>---</p>

<h2>CRITICAL: Export Format Requirements</h2>
<p>The tracker MUST export Excel files with these EXACT sheet names and column structures.</p>
The ETL will compute calculated fields - tracker only provides INPUT fields.
<p>---</p>

<h2>Sheet 1: <code>events</code> (LONG FORMAT)</h2>

<strong>Format:</strong> One row PER PLAYER PER EVENT
<p>If event has 3 players, it generates 3 rows with same event_index.</p>

<h3>Input Columns (Tracker Provides)</h3>

<pre><code class="language-"># Flag columns
event_index_flag_           # 1 for first player row (event_player_1), 0 for others
sequence_index_flag_        # Optional grouping
play_index_flag_            # Optional grouping
linked_event_index_flag_    # For linked events

<h1>Time (from game clock - countdown format like 17:45)</h1>
event_start_min_            # Start minute (17 from "17:45")
event_start_sec_            # Start second (45 from "17:45")
event_end_min_              # End minute
event_end_sec_              # End second

<h1>Player (changes per row)</h1>
player_game_number_         # Jersey number for THIS row's player
player_game_number          # Jersey number (duplicate)

<h1>Zone</h1>
event_team_zone_            # 'o', 'n', or 'd' from event team perspective

<h1>Event type & details (SAME for all rows of same event)</h1>
event_type_                 # Faceoff, Shot, Pass, Goal, etc.
event_detail_               # Shot_OnNetSaved, Pass_Completed, etc.
event_detail_2_             # Shot-Wrist, Pass-Forehand, etc.
event_successful_           # 's' or 'u'

<h1>Play details (DIFFERENT per player row)</h1>
play_detail1_               # This player's offensive/defensive play
play_detail2_               # Play detail 2
play_detail_successful_     # 's' or 'u' for THIS player
pressured_pressurer_        # 'pressured' or 'pressurer' or blank

<h1>Index tracking</h1>
event_index_                # Sequential event number (1, 2, 3...)
linked_event_index_         # Index of linked event (for Shot→Save chains)
sequence_index_             # Sequence grouping
play_index_                 # Play grouping

<h1>Team (changes based on player role)</h1>
team_                       # 'h' or 'a' for THIS row's player's team
role_abrev_binary_          # 'e' or 'o' (event team or opposing)
role_abrev                  # 'e' or 'o'

<h1>Venue</h1>
team_venue_                 # 'Home' or 'Away' for this player
team_venue_abv_             # 'h' or 'a'

<h1>Zones from different perspectives</h1>
event_team_zone2_           # Copy of zone
home_team_zone_             # Zone from home team perspective
away_team_zone_             # Zone from away team perspective

<h1>Game info</h1>
game_id                     # Game ID (18977)
home_team                   # Home team name
away_team                   # Away team name

<h1>Event type copies</h1>
Type                        # Same as event_type_
event_detail                # Same as event_detail_
event_detail_2              # Same as event_detail_2_

<h1>Shift link</h1>
shift_index                 # Which shift this event belongs to

<h1>Player identification</h1>
player_role                 # event_team_player_1, event_team_player_2, opp_team_player_1, etc.
role_number                 # 1, 2, 3, 4 (player number within role type)
player_id                   # Player ID (P100084)
player_team                 # This player's team name
</code></pre>

<h3>Calculated by ETL (Don't include or leave blank)</h3>

<pre><code class="language-">event_index                 # Formatted as game_id * 10000 + event_index_
tracking_event_index        # Copy of event_index
period                      # (Actually INPUT - include this!)
event_start_min             # Copies of the underscore versions
event_start_sec
event_end_min
event_end_sec
event_team_zone             # Copy
home_team_zone              # Calculated
away_team_zone              # Calculated
team_venue                  # Copy
team_venue_abv              # Copy
side_of_puck                # Calculated from zone
sequence_index              # Copy
play_index                  # Copy
play_detail1                # Copy
play_detail_2               # Copy
play_detail_successful      # Copy
pressured_pressurer         # Copy
zone_change_index           # Calculated
duration                    # Calculated
time_start_total_seconds    # Calculated from period + time
time_end_total_seconds      # Calculated
running_intermission_duration  # Calculated
period_start_total_running_seconds  # Calculated
running_video_time          # Calculated
event_running_start         # Calculated
event_running_end           # Calculated
player_num_dup_             # Calculated
event_successful            # Copy (sometimes different logic)
linked_event_index          # Copy
</code></pre>
<p>---</p>

<h2>Sheet 2: <code>shifts</code> (WIDE FORMAT)</h2>

<strong>Format:</strong> One row PER SHIFT

<h3>Input Columns (Tracker Provides)</h3>

<pre><code class="language-"># Core
shift_index                 # Sequential (1, 2, 3...)
Period                      # 1, 2, 3, OT

<h1>Time (countdown format)</h1>
shift_start_min             # Start minute
shift_start_sec             # Start second
shift_end_min               # End minute
shift_end_sec               # End second

<h1>Start/Stop types</h1>
shift_start_type            # GameStart, PeriodStart, OtherFaceoff, etc.
shift_stop_type             # Period End, Home Goal, Away Goalie Stopped, etc.

<h1>Home lineup (jersey numbers)</h1>
home_forward_1
home_forward_2
home_forward_3
home_defense_1
home_defense_2
home_xtra                   # Extra attacker
home_goalie

<h1>Away lineup (jersey numbers)</h1>
away_forward_1
away_forward_2
away_forward_3
away_defense_1
away_defense_2
away_xtra
away_goalie

<h1>Stoppage</h1>
stoppage_time               # Duration of stoppage in seconds

<h1>Zone tracking (1 if true, blank if false)</h1>
home_ozone_start            # Shift started in home offensive zone
home_ozone_end              # Shift ended in home offensive zone
home_dzone_start
home_dzone_end
home_nzone_start
home_nzone_end

<h1>Game info</h1>
game_id
home_team
away_team
</code></pre>

<h3>Calculated by ETL</h3>

<pre><code class="language-">shift_start_total_seconds   # From period + time
shift_end_total_seconds
shift_duration              # End - start
home_team_strength          # Count of home skaters
away_team_strength          # Count of away skaters
home_team_en                # Empty net flag
away_team_en
home_team_pk                # Penalty kill flag
home_team_pp                # Power play flag
away_team_pp
away_team_pk
situation                   # "Full Strength", "Power Play", etc.
strength                    # "5v5", "5v4", etc.
home_goals                  # Current score
away_goals
home_team_plus              # Plus/minus
home_team_minus
away_team_plus
away_team_minus
period_start_total_running_seconds
running_video_time
shift_start_running_time
shift_end_running_time
</code></pre>
<p>---</p>

<h2>Sheet 3: <code>game_rosters</code> (Optional, for validation)</h2>
<p>Links player numbers to player IDs.</p>

<hr>

<h2>XY Data</h2>
<p>XY data stored SEPARATELY in CSV files:</p>

<strong>Location:</strong> <code>data/raw/games/{game_id}/xy/event_locations/{game_id}_{period}.csv</code>

<h3>Columns</h3>

<pre><code class="language-">game_id
link_event_index            # Links to event_index
Player                      # Jersey number OR 'puck'
X                           # Position 1 X coordinate
Y                           # Position 1 Y coordinate
X2                          # Position 2 X coordinate (if multiple positions)
Y2
X3
Y3
... up to X10, Y10
Distance                    # Calculated distance traveled
</code></pre>
<p>---</p>

<h2>Shift Start Types (from dim table)</h2>

<pre><code class="language-">GameStart
PeriodStart
FaceoffAfterGoal
FaceoffAfterPenalty
OtherFaceoff
DeadIce/Stoppage
Intermission
DelayedPenalty
</code></pre>

<h2>Shift Stop Types (from dim table)</h2>

<pre><code class="language-">Period End
Period Start (for intermission)
Home Goal
Away Goal
Home Goalie Stopped (after Away SOG)
Away Goalie Stopped (after Home SOG)
Home Penalty
Away Penalty
Home Offside
Away Offside
Home Icing
Away Icing
Puck Out of Play
DeadIce/Stoppage
TV timeout
Home Timeout
Visitor Timeout
Player Injury
GameEnd
... (and many more - see Lists tab)
</code></pre>
<p>---</p>

<h2>Event Types</h2>

<pre><code class="language-">Faceoff
Shot
Pass
Goal
Turnover
Zone_Entry_Exit
Penalty
PenaltyShot_Shootout
Stoppage
Hit
Possession
LoosePuck
Save
TeamPossessionChange
Rebound
DeadIce
Play
Timeout
Intermission
Clockstop
GameStart
GameEnd
</code></pre>
<p>---</p>

<h2>Cascading Detail Dropdowns</h2>

<h3>Shot → Detail 1 → Detail 2</h3>
<pre><code class="language-">Shot:
  Shot_OnNetSaved → Shot-Wrist, Shot-Slap, Shot-Backhand, Shot-Snap, Shot-Tip, etc.
  Shot_Missed → Same shot types
  Shot_Blocked → Same shot types
  Shot_Goal → Same shot types
</code></pre>

<h3>Pass → Detail 1 → Detail 2</h3>
<pre><code class="language-">Pass:
  Pass_Completed → Pass-Forehand, Pass-Backhand, Pass-Saucer, Pass-Stretch, etc.
  Pass_Missed → Same pass types
  Pass_Intercepted → Same pass types
</code></pre>

<h3>Turnover → Detail 1 → Detail 2</h3>
<pre><code class="language-">Turnover:
  Turnover_Giveaway → Giveaway-Misplayed, Giveaway-BattleLost, etc.
  Turnover_Takeaway → Takeaway-PokeCheck, Takeaway-BattleWon, etc.
</code></pre>
<p>---</p>

<h2>Player Roles</h2>

<pre><code class="language-">event_team_player_1         # Primary player for event team
event_team_player_2         # Second player for event team
event_team_player_3
event_team_player_4
<p>opp_team_player_1           # Primary opposing player</p>
opp_team_player_2
opp_team_player_3
opp_team_player_4
</code></pre>
<p>---</p>

<h2>Success/Unsuccessful Logic</h2>

<code>event_successful_</code> and <code>play_detail_successful_</code> use:
<ul>
<li><code>s</code> = successful</li>
<li><code>u</code> = unsuccessful</li>
</ul>
<p>Applied logic:</p>
<ul>
<li>Shot_OnNetSaved: Usually 's' (shot was on target)</li>
<li>Shot_Missed: 'u'</li>
<li>Pass_Completed: 's'</li>
<li>Pass_Intercepted: 'u'</li>
<li>Turnover_Giveaway: 'u' (for team that gave it away)</li>
<li>Turnover_Takeaway: 's' (for team that took it away)</li>
</ul>
<p>Play details have their own s/u per player.</p>

<hr>

<h2>Zone Calculation</h2>
<p>Based on event_team_player_1's first XY position:</p>

<pre><code class="language-">Rink coordinates: X from -100 to +100
<p>For HOME team events:</p>
  X &gt; 25  → zone = 'o' (offensive - attacking right)
  X &lt; -25 → zone = 'd' (defensive - defending left)
  else    → zone = 'n' (neutral)
<p>For AWAY team events:</p>
  X &lt; -25 → zone = 'o' (offensive - attacking left)
  X &gt; 25  → zone = 'd' (defensive - defending right)
  else    → zone = 'n' (neutral)
</code></pre>
<p>---</p>

<h2>Intermission Handling</h2>
<p>Intermissions are special shifts where:</p>
<ul>
<li><code>shift_start_type = 'Intermission'</code></li>
<li>All player slots are EMPTY</li>
<li><code>stoppage_time</code> contains duration in seconds</li>
<li>Critical for video timestamp calculations</li>
</ul>
<p>---</p>

<h2>Time Format</h2>
<p>All times are in COUNTDOWN format (like NHL game clock):</p>
<ul>
<li>Period starts at 18:00 (or 20:00 for NHL)</li>
<li>Counts down to 0:00</li>
<li>Example: "15:42" means 15 minutes 42 seconds remaining</li>
</ul>
<p>Total seconds calculation:</p>
<pre><code class="language-">period_seconds = (period - 1) <em> 18 </em> 60  # For 18-min periods
time_from_period_start = (18 <em> 60) - (minutes </em> 60 + seconds)
total_seconds = period_seconds + time_from_period_start
</code></pre>
<p>---</p>

<h2>Video Time Calculation</h2>

<pre><code class="language-">running_video_time = time_from_game_start + total_intermission_duration
<p>Where:</p>
<ul>
<li>time_from_game_start = total_seconds</li>
<li>total_intermission_duration = sum of all intermission stoppage_time values up to this point</li>
</ul>
</code></pre>

</div>
</main>
<footer>
  <div class="container">
    BenchSight Documentation • v14.01 • January 7, 2026
  </div>
</footer>
</body>
</html>
