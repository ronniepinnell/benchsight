<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BenchSight Tracking Template Documentation - BenchSight</title>
<style>
:root {
  --bg: #0d1117;
  --surface: #161b22;
  --border: #30363d;
  --text: #c9d1d9;
  --muted: #8b949e;
  --accent: #58a6ff;
  --accent2: #3fb950;
  --warn: #d29922;
  --danger: #f85149;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
  font-size: 14px;
}
.container { max-width: 900px; margin: 0 auto; padding: 20px 40px; }
header {
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  padding: 15px 0;
}
header .container { display: flex; justify-content: space-between; align-items: center; }
header h1 {
  font-size: 18px;
  color: var(--accent);
}
header nav a {
  color: var(--muted);
  text-decoration: none;
  margin-left: 15px;
  font-size: 13px;
}
header nav a:hover { color: var(--accent); }
main { padding: 30px 0; }
h1 { font-size: 28px; color: var(--accent); margin-bottom: 20px; }
h2 { font-size: 22px; color: var(--text); margin: 30px 0 15px; padding-bottom: 8px; border-bottom: 1px solid var(--border); }
h3 { font-size: 18px; color: var(--accent2); margin: 25px 0 12px; }
h4 { font-size: 15px; color: var(--text); margin: 20px 0 10px; }
p { margin: 12px 0; color: var(--text); }
ul, ol { margin: 12px 0 12px 25px; }
li { margin: 6px 0; }
code {
  font-family: 'SF Mono', Consolas, monospace;
  background: var(--surface);
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 13px;
  border: 1px solid var(--border);
}
pre {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 15px;
  overflow-x: auto;
  margin: 15px 0;
  font-size: 12px;
}
pre code { background: none; border: none; padding: 0; }
table {
  width: 100%;
  border-collapse: collapse;
  margin: 15px 0;
  font-size: 13px;
}
th, td {
  border: 1px solid var(--border);
  padding: 10px 12px;
  text-align: left;
}
th { background: var(--surface); color: var(--accent); }
tr:nth-child(even) { background: rgba(255,255,255,0.02); }
blockquote {
  border-left: 3px solid var(--accent);
  padding: 10px 15px;
  margin: 15px 0;
  background: rgba(88,166,255,0.1);
  border-radius: 0 6px 6px 0;
}
hr { border: none; border-top: 1px solid var(--border); margin: 30px 0; }
a { color: var(--accent); text-decoration: none; }
a:hover { text-decoration: underline; }
strong { color: var(--text); }
.badge {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
}
.badge-done { background: var(--accent2); color: #000; }
.badge-pending { background: var(--warn); color: #000; }
footer {
  border-top: 1px solid var(--border);
  padding: 20px 0;
  margin-top: 40px;
  text-align: center;
  color: var(--muted);
  font-size: 12px;
}
</style>
</head>
<body>
<header>
  <div class="container">
    <h1>⚡ BenchSight</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="tracker/index.html">Tracker</a>
      <a href="tables.html">Tables</a>
      <a href="diagrams/ERD_VIEWER.html">ERD</a>
    </nav>
  </div>
</header>
<main>
<div class="container">
<h1>BenchSight Tracking Template Documentation</h1>

<strong>File:</strong> <code>_tracking.xlsx</code>  
<strong>Purpose:</strong> Manual game event and shift tracking from video  
<strong>Generated:</strong> 2026-01-07
<p>---</p>

<h2>Table of Contents</h2>

<ol>
<li>1. <a href="#sheet-overview">Sheet Overview</a></li>
<li>2. <a href="#events-sheet---deep-dive">Events Sheet - Deep Dive</a></li>
<li>3. <a href="#shifts-sheet---deep-dive">Shifts Sheet - Deep Dive</a></li>
<li>4. <a href="#lists-sheet---data-validation-sources">Lists Sheet - Data Validation Sources</a></li>
<li>5. <a href="#named-ranges">Named Ranges</a></li>
<li>6. <a href="#cross-sheet-interactions">Cross-Sheet Interactions</a></li>
<li>7. <a href="#formula-logic-analysis">Formula Logic Analysis</a></li>
<li>8. <a href="#data-entry-workflow">Data Entry Workflow</a></li>
</ul>
<p>---</p>

<h2>Sheet Overview</h2>

<table>
<thead><tr><th>Sheet</th><th>Rows</th><th>Cols</th><th>Purpose</th></tr></thead>
<tbody><tr><td><strong>events</strong></td><td>860</td><td>72</td><td>Main event tracking - shots, passes, goals, etc.</td></tr><tr><td><strong>shifts</strong></td><td>202</td><td>55</td><td>Line change tracking with player assignments</td></tr><tr><td><strong>Lists</strong></td><td>139</td><td>69</td><td>Dropdown validation lists for all event types</td></tr><tr><td><strong>Rules</strong></td><td>147</td><td>73</td><td>Event type definitions and relationships</td></tr><tr><td><strong>game_rosters</strong></td><td>57</td><td>54</td><td>Player roster data (linked from external BLB_Tables.xlsx)</td></tr><tr><td><strong>examples</strong></td><td>66</td><td>51</td><td>Sample tracking data</td></tr><tr><td><strong>Sheet1</strong></td><td>72</td><td>3</td><td>Misc</td></tr></tbody></table>
<hr>

<h2>Events Sheet - Deep Dive</h2>

<h3>Column Classification</h3>
<p>The events sheet has <strong>72 columns</strong> divided into:</p>

<h4>INPUT COLUMNS (User enters these - suffix <code>_</code>)</h4>

<table>
<thead><tr><th>Col</th><th>Header</th><th>Purpose</th><th>Data Validation</th></tr></thead>
<tbody><tr><td>A</td><td><code>event_index_flag_</code></td><td>Flag to create new event (1 or blank)</td><td>Manual</td></tr><tr><td>B</td><td><code>sequence_index_flag_</code></td><td>Flag for new sequence</td><td>Manual</td></tr><tr><td>C</td><td><code>play_index_flag_</code></td><td>Flag for new play</td><td>Manual</td></tr><tr><td>D</td><td><code>linked_event_index_flag_</code></td><td>Flag for linked event</td><td>Manual</td></tr><tr><td>E</td><td><code>event_start_min_</code></td><td>Event start minute (0-20)</td><td>Manual</td></tr><tr><td>F</td><td><code>event_start_sec_</code></td><td>Event start second (0-59)</td><td>Manual</td></tr><tr><td>G</td><td><code>event_end_min_</code></td><td>Event end minute</td><td>Manual</td></tr><tr><td>H</td><td><code>event_end_sec_</code></td><td>Event end second</td><td>Manual</td></tr><tr><td><strong>I</strong></td><td><strong><code>player_game_number_</code></strong></td><td><strong>Jersey number of player</strong></td><td>Manual</td></tr><tr><td><strong>J</strong></td><td><strong><code>event_team_zone_</code></strong></td><td><strong>Zone: o/d/n</strong></td><td>Manual: o=offensive, d=defensive, n=neutral</td></tr><tr><td><strong>K</strong></td><td><strong><code>event_type_</code></strong></td><td><strong>Primary event type</strong></td><td>Dropdown: <code>EventType</code> named range</td></tr><tr><td><strong>L</strong></td><td><strong><code>event_detail_</code></strong></td><td><strong>Event detail/subtype</strong></td><td>Cascading dropdown based on K</td></tr><tr><td><strong>M</strong></td><td><strong><code>event_detail_2_</code></strong></td><td><strong>Secondary detail (shot type, etc.)</strong></td><td>Cascading dropdown based on L</td></tr><tr><td>N</td><td><code>event_successful_</code></td><td>Success flag (s/u)</td><td>Formula-calculated</td></tr><tr><td>O</td><td><code>play_detail1_</code></td><td>Play detail</td><td>Dropdown</td></tr><tr><td>P</td><td><code>play_detail2_</code></td><td>Secondary play detail</td><td>Dropdown</td></tr><tr><td>Q</td><td><code>play_detail_successful_</code></td><td>Play success</td><td>Manual</td></tr><tr><td>R</td><td><code>pressured_pressurer_</code></td><td>Pressure indicator</td><td>Manual</td></tr><tr><td>S</td><td><code>event_index_</code></td><td>Manual event index override</td><td>Manual</td></tr><tr><td>T</td><td><code>linked_event_index_</code></td><td>Manual linked event index</td><td>Manual</td></tr><tr><td>U</td><td><code>sequence_index_</code></td><td>Manual sequence index</td><td>Manual</td></tr><tr><td>V</td><td><code>play_index_</code></td><td>Manual play index</td><td>Manual</td></tr><tr><td><strong>W</strong></td><td><strong><code>team_</code></strong></td><td><strong>Team: h=home, a=away</strong></td><td>Manual: h/a</td></tr><tr><td>X</td><td><code>player_game_number</code></td><td>Duplicate of I</td><td>Reference</td></tr><tr><td>Y</td><td><code>role_abrev_binary_</code></td><td>Role: 1=event team, 2=opp, x=system</td><td>Manual</td></tr></tbody></table>
<h4>CALCULATED COLUMNS (Formulas - no suffix)</h4>

<table>
<thead><tr><th>Col</th><th>Header</th><th>Formula Logic</th></tr></thead>
<tbody><tr><td>Z</td><td><code>period</code></td><td><code>=IF(K="Intermission",Z_prev+1,Z_prev)</code> - Increments on intermission</td></tr><tr><td>AA</td><td><code>event_index</code></td><td><code>=S+1000</code> - Adds 1000 offset to manual index</td></tr><tr><td>AB</td><td><code>linked_event_index</code></td><td><code>=IF(T<>"",9000+T,"")</code> - Adds 9000 offset</td></tr><tr><td>AC</td><td><code>tracking_event_index</code></td><td><code>=IF(AB<>"",AB,S+1000)</code> - Uses linked or event index</td></tr><tr><td>AD</td><td><code>event_start_min</code></td><td>Copied from E or carried forward</td></tr><tr><td>AE</td><td><code>event_start_sec</code></td><td>Copied from F or carried forward</td></tr><tr><td>AF</td><td><code>event_end_min</code></td><td><code>=IF(G<>"",G,IF(S=S_prev,AF_prev,""))</code> - Carries forward within event</td></tr><tr><td>AG</td><td><code>event_end_sec</code></td><td>Same pattern as AF</td></tr><tr><td>AH</td><td><code>role_abrev</code></td><td><code>=IF(Y="x","",IF(Y=1,"e","o"))</code> - Converts binary to e/o</td></tr><tr><td>AI</td><td><code>event_team_zone2_</code></td><td>Zone with carryforward</td></tr><tr><td>AJ</td><td><code>event_team_zone</code></td><td>Zone with carryforward</td></tr><tr><td>AK</td><td><code>home_team_zone_</code></td><td><strong>Complex zone flip logic</strong> (see below)</td></tr><tr><td>AL</td><td><code>away_team_zone_</code></td><td>Inverse of home zone</td></tr><tr><td>AM</td><td><code>team_venue_</code></td><td>"Home" or "Away" from abrev</td></tr><tr><td>AN</td><td><code>team_venue_abv_</code></td><td>h/a with carryforward</td></tr><tr><td>AO</td><td><code>home_team_zone</code></td><td>Zone with carryforward</td></tr><tr><td>AP</td><td><code>away_team_zone</code></td><td>Zone with carryforward</td></tr><tr><td>AQ</td><td><code>team_venue</code></td><td>Full name with carryforward</td></tr><tr><td>AR</td><td><code>team_venue_abv</code></td><td>Abbreviation with carryforward</td></tr><tr><td>AS</td><td><code>side_of_puck</code></td><td><strong>"Offensive"/"Defensive" based on role and event type</strong></td></tr><tr><td>AT</td><td><code>sequence_index</code></td><td><code>=IF(U<>"",U+5000,"")</code> - Adds 5000 offset</td></tr><tr><td>AU</td><td><code>play_index</code></td><td><code>=IF(V<>"",V+6000,"")</code> - Adds 6000 offset</td></tr><tr><td>AV</td><td><code>play_detail1</code></td><td><strong>Array formula - FILTER lookup for linked events</strong></td></tr><tr><td>AW</td><td><code>play_detail_2</code></td><td>Array formula</td></tr><tr><td>AX</td><td><code>play_detail_successful</code></td><td>Array formula</td></tr><tr><td>AY</td><td><code>pressured_pressurer</code></td><td>Array formula</td></tr><tr><td>AZ</td><td><code>zone_change_index</code></td><td>Manual/calculated</td></tr><tr><td>BA</td><td><code>game_id</code></td><td>From game setup</td></tr><tr><td>BB</td><td><code>home_team</code></td><td>From game setup</td></tr><tr><td>BC</td><td><code>away_team</code></td><td>From game setup</td></tr><tr><td>BD</td><td><code>Type</code></td><td><code>=IF(K<>"",K,IF(S=S_prev,K,""))</code> - event_type with carryforward</td></tr><tr><td>BE</td><td><code>event_detail</code></td><td>Calculated detail</td></tr><tr><td>BF</td><td><code>event_detail_2</code></td><td>Calculated detail2</td></tr><tr><td>BG</td><td><code>event_successful</code></td><td>Calculated success</td></tr><tr><td>BH</td><td><code>shift_index</code></td><td>Link to shifts sheet</td></tr><tr><td>BI</td><td><code>duration</code></td><td>Event duration in seconds</td></tr><tr><td>BJ</td><td><code>time_start_total_seconds</code></td><td>Start time as total seconds</td></tr><tr><td>BK</td><td><code>time_end_total_seconds</code></td><td>End time as total seconds</td></tr><tr><td>BL</td><td><code>running_intermission_duration</code></td><td>Accumulated intermission time</td></tr><tr><td>BM</td><td><code>period_start_total_running_seconds</code></td><td>Period start in video time</td></tr><tr><td>BN</td><td><code>running_video_time</code></td><td>Current video timestamp</td></tr><tr><td>BO</td><td><code>event_running_start</code></td><td><code>=IF(BN<5,0,BN-5)</code> - Video start minus 5 sec buffer</td></tr><tr><td>BP</td><td><code>event_running_end</code></td><td><code>=BO+BI+5</code> - End plus 5 sec buffer</td></tr><tr><td>BQ</td><td><code>player_role</code></td><td>Full role name</td></tr><tr><td>BR</td><td><code>role_number</code></td><td>Numeric role</td></tr><tr><td>BS</td><td><code>player_id</code></td><td><strong>VLOOKUP to game_rosters</strong></td></tr><tr><td>BT</td><td><code>player_team</code></td><td><strong>Derived from venue + role</strong></td></tr></tbody></table>
<h3>Key Formula Details</h3>

<h4>Event Index Auto-Increment (S column)</h4>
<pre><code class="language-excel">=IF(A3=1,MAX($S$2:$S2)+1,IF($I3&lt;&gt;"",$S2,""))
</code></pre>
<ul>
<li>If flag A=1: Creates new event with next index</li>
<li>If jersey number entered: Carries forward same event index (multi-player event)</li>
<li>Otherwise: Blank</li>
</ul>

<h4>Zone Flip Logic (AK column - home_team_zone_)</h4>
<pre><code class="language-excel">=IF($W2="",
    "",
    IF($AI2="",
        "",
        IF($W2="h",
            $AI2,
            IF($AI2="n",
                "n",
                IF(AND($W2="a",$AI2="d"),
                    "o",
                    IF(AND($W2="a",$AI2="o"),
                        "d"
                    )
                )
            )
        )
    )
)
</code></pre>
<ul>
<li>If team is home (h): Zone is as entered</li>
<li>If team is away (a): Zone is flipped (o↔d, n stays n)</li>
</ul>

<h4>Side of Puck Logic (AS column)</h4>
<pre><code class="language-excel">=IF(AND(AH2="e",OR(BD2="Save",BE2="Turnover_Takeaway",BE2="Play_Defensive")),
    "Defensive",
    IF(AND(AH2="o",OR(BD2="Save",BE2="Turnover_Takeaway",BE2="Play_Defensive")),
        "Offensive",
        IF(OR(BD2="Deadice",BD2="Stoppage",BD2="Intermission"),
            "",
            IF(AH2="e",
                "Offensive",
                IF(AH2="o",
                    "Defensive",
                    ""
                )
            )
        )
    )
)
</code></pre>
<ul>
<li>Determines if player is on offensive or defensive side of puck</li>
<li>Considers event type (saves, takeaways are defensive)</li>
<li>Uses role (e=event team, o=opposing)</li>
</ul>

<h4>Event Success Auto-Calculation (N column)</h4>
<pre><code class="language-excel">=IF(K="",
    "",
    IF(K="Goal",
        "s",
        IF(AND(K="Zone_Entry_Exit",OR(SEARCH("fail",L),SEARCH("FromExitClear",M),SEARCH("miss",M))),
            "u",
            IF(AND(K="Zone_Entry_Exit",...),
                "s",
                IF(AND(OR(K="Shot",K="Pass"),OR(SEARCH("complete",L),SEARCH("goal",L),SEARCH("OnNet",L))),
                    "s",
                    IF(L="Turnover_Giveaway",
                        "u",
                        IF(AND(OR(K="Shot",K="Pass"),...),
                            "u",
                            ""
                        )
                    )
                )
            )
        )
    )
)
</code></pre>
<ul>
<li>Goals always successful ("s")</li>
<li>Zone entries: Check for "fail" in detail → unsuccessful</li>
<li>Shots/Passes: Check for "complete", "goal", "OnNet" → successful</li>
<li>Giveaways always unsuccessful ("u")</li>
</ul>

<h4>Player ID Lookup (BS column)</h4>
<pre><code class="language-excel">=IFERROR(VLOOKUP(BA2&BT2&I2,game_rosters!U:W,3,FALSE),"")
</code></pre>
<ul>
<li>Concatenates: game_id + player_team + jersey_number</li>
<li>Looks up in game_rosters column U (composite key)</li>
<li>Returns player_id from column W</li>
</ul>

<h4>Player Team Derivation (BT column)</h4>
<pre><code class="language-excel">=IF(AQ2="",
    "",
    IF(AND(AQ2="Away",AH2="e"),
        BC2,
        IF(AND(AQ2="Home",AH2="e"),
            BB2,
            IF(AND(AQ2="Away",AH2="o"),
                BB2,
                IF(AND(AQ2="Home",AH2="o"),
                    BC2
                )
            )
        )
    )
)
</code></pre>
<ul>
<li>If venue=Away and role=event team (e): away_team name</li>
<li>If venue=Home and role=event team (e): home_team name</li>
<li>If venue=Away and role=opposing (o): home_team name</li>
<li>If venue=Home and role=opposing (o): away_team name</li>
</ul>
<p>---</p>

<h2>Shifts Sheet - Deep Dive</h2>

<h3>Column Classification</h3>

<h4>INPUT COLUMNS (User enters these)</h4>

<table>
<thead><tr><th>Col</th><th>Header</th><th>Purpose</th></tr></thead>
<tbody><tr><td>A</td><td><code>shift_index</code></td><td>Sequential shift number</td></tr><tr><td>B</td><td><code>Period</code></td><td>Period number</td></tr><tr><td>C</td><td><code>shift_start_min</code></td><td>Start minute (0-20)</td></tr><tr><td>D</td><td><code>shift_start_sec</code></td><td>Start second (0-59)</td></tr><tr><td>E</td><td><code>shift_end_min</code></td><td>End minute</td></tr><tr><td>F</td><td><code>shift_end_sec</code></td><td>End second</td></tr><tr><td>G</td><td><code>shift_start_type</code></td><td>How shift started (dropdown)</td></tr><tr><td>H</td><td><code>shift_stop_type</code></td><td>How shift ended (dropdown)</td></tr><tr><td>I-N</td><td><code>home_forward_1</code> thru <code>home_xtra</code></td><td>Home team skater jersey numbers</td></tr><tr><td>O</td><td><code>home_goalie</code></td><td>Home goalie jersey number</td></tr><tr><td>P-U</td><td><code>away_forward_1</code> thru <code>away_xtra</code></td><td>Away team skater jersey numbers</td></tr><tr><td>V</td><td><code>away_goalie</code></td><td>Away goalie jersey number</td></tr><tr><td>X-AC</td><td>Zone time tracking</td><td>Zone start/end tracking</td></tr></tbody></table>
<h4>CALCULATED COLUMNS</h4>

<table>
<thead><tr><th>Col</th><th>Header</th><th>Formula</th></tr></thead>
<tbody><tr><td>W</td><td><code>stoppage_time</code></td><td>SUMIFS for DeadIce/Timeout events during shift</td></tr><tr><td>AD</td><td><code>game_id</code></td><td><code>=events!BA2</code></td></tr><tr><td>AE</td><td><code>home_team</code></td><td><code>=events!BB2</code></td></tr><tr><td>AF</td><td><code>away_team</code></td><td><code>=events!BC2</code></td></tr><tr><td>AG</td><td><code>shift_start_total_seconds</code></td><td><code>=(C*60)+D</code></td></tr><tr><td>AH</td><td><code>shift_end_total_seconds</code></td><td><code>=(E*60)+F</code></td></tr><tr><td>AI</td><td><code>shift_duration</code></td><td><code>=ROUND(AG-AH,0)</code></td></tr><tr><td>AJ</td><td><code>home_team_strength</code></td><td><code>=COUNTIF(I:N,">0")</code> - Count non-empty skaters</td></tr><tr><td>AK</td><td><code>away_team_strength</code></td><td><code>=COUNTIF(P:U,">0")</code></td></tr><tr><td>AL</td><td><code>home_team_en</code></td><td><code>=IF(O="",1,0)</code> - Empty net flag</td></tr><tr><td>AM</td><td><code>away_team_en</code></td><td><code>=IF(V="",1,0)</code></td></tr><tr><td>AN</td><td><code>home_team_pk</code></td><td>Penalty kill flag</td></tr><tr><td>AO</td><td><code>home_team_pp</code></td><td>Power play flag</td></tr><tr><td>AP</td><td><code>away_team_pp</code></td><td>Power play flag</td></tr><tr><td>AQ</td><td><code>away_team_pk</code></td><td>Penalty kill flag</td></tr><tr><td>AR</td><td><code>situation</code></td><td>"Full Strength", "Home PowerPlay", etc.</td></tr><tr><td>AS</td><td><code>strength</code></td><td>"5v5", "5v4 Home EN", etc.</td></tr><tr><td>AT</td><td><code>home_goals</code></td><td>Running home goal count</td></tr><tr><td>AU</td><td><code>away_goals</code></td><td>Running away goal count</td></tr><tr><td>AV-AY</td><td>Plus/Minus</td><td>Goal differential flags</td></tr><tr><td>AZ</td><td><code>period_start_total_running_seconds</code></td><td>VLOOKUP to events</td></tr><tr><td>BA</td><td><code>running_video_time</code></td><td>Video timestamp</td></tr><tr><td>BB</td><td><code>shift_start_running_time</code></td><td><code>=IF(BA<5,0,BA-5)</code></td></tr><tr><td>BC</td><td><code>shift_end_running_time</code></td><td><code>=BB+AI+3</code></td></tr></tbody></table>
<h3>Key Formula Details</h3>

<h4>Stoppage Time Calculation (W column)</h4>
<pre><code class="language-excel">=SUMIFS(events!BI:BI,events!K:K,"=DeadIce",events!BJ:BJ,"&lt;="&shifts!AG2,events!BK:BK,"&gt;"&shifts!AH2,events!Z:Z,"="&shifts!B3)
+SUMIFS(events!BI:BI,events!K:K,"=Timeout",events!BJ:BJ,"&lt;="&shifts!AG2,events!BK:BK,"&gt;"&shifts!AH2,events!Z:Z,"="&shifts!B3)
</code></pre>
<ul>
<li>Sums duration of DeadIce and Timeout events</li>
<li>Within the time range of current shift</li>
<li>Within same period</li>
</ul>

<h4>Strength Calculation (AJ column)</h4>
<pre><code class="language-excel">=COUNTIF(I2:N2,"&gt;0")
</code></pre>
<ul>
<li>Counts non-empty player cells</li>
<li>Result: Number of skaters (typically 5, fewer during penalties)</li>
</ul>

<h4>Situation Logic (AR column)</h4>
<pre><code class="language-excel">=IF(AND(AJ2=5,AK2=5,AL2=0,AM2=0),
    "Full Strength",
    IF(AP2=1,
        "Away PowerPlay",
        IF(AO2=1,
            "Home PowerPlay",
            IF(AL2=1,
                "Home EmptyNet",
                IF(AM2=1,
                    "Away EmptyNet",
                    ""
                )
            )
        )
    )
)
</code></pre>

<h4>Strength String (AS column)</h4>
<pre><code class="language-excel">=IF(AND(AL2=0,AM2=0),
    AJ2&"v"&AK2,
    IF(AL2=1,
        AJ2&"v"&AK2&" Home EN",
        IF(AM2=1,
            AJ2&"v"&AK2&" Away EN",
            ""
        )
    )
)
</code></pre>
<ul>
<li>Generates strings like "5v5", "5v4", "4v4 Home EN"</li>
</ol>
<p>---</p>

<h2>Lists Sheet - Data Validation Sources</h2>

<h3>Event Type Hierarchy</h3>
<p>The dropdowns use a <strong>cascading hierarchy</strong>:</p>

<pre><code class="language-">event_type_ (K) → event_detail_ (L) → event_detail_2_ (M)
</code></pre>

<h4>Level 1: Event Types (Column A)</h4>
<table>
<thead><tr><th>EventType</th></tr></thead>
<tbody><tr><td>Faceoff</td></tr><tr><td>Shot</td></tr><tr><td>Pass</td></tr><tr><td>Goal</td></tr><tr><td>Turnover</td></tr><tr><td>Zone_Entry_Exit</td></tr><tr><td>Penalty</td></tr><tr><td>PenaltyShot_Shootout</td></tr><tr><td>Stoppage</td></tr><tr><td>Hit</td></tr><tr><td>Possession</td></tr><tr><td>LoosePuck</td></tr><tr><td>Save</td></tr><tr><td>TeamPossessionChange</td></tr><tr><td>Rebound</td></tr><tr><td>DeadIce</td></tr><tr><td>Play</td></tr><tr><td>Timeout</td></tr><tr><td>Intermission</td></tr><tr><td>GameStart</td></tr><tr><td>GameEnd</td></tr></tbody></table>
<h4>Level 2: Event Details (varies by type)</h4>

<strong>Shot details:</strong>
<ul>
<li>Shot_OnNetSaved</li>
<li>Shot_Missed</li>
<li>Shot_Blocked</li>
<li>Shot_BlockedSameTeam</li>
<li>Shot_Deflected</li>
<li>Shot_DeflectedOnNetSaved</li>
<li>Shot_Tipped</li>
<li>Shot_TippedOnNetSaved</li>
</ul>

<strong>Pass details:</strong>
<ul>
<li>Pass_Completed</li>
<li>Pass_Missed</li>
<li>Pass_Deflected</li>
<li>Pass_Intercepted</li>
</ul>

<strong>Goal details:</strong>
<ul>
<li>Goal_Scored</li>
<li>Goal_Shootout</li>
<li>Goal_PenaltyShot</li>
</ul>

<strong>Turnover details:</strong>
<ul>
<li>Turnover_Giveaway</li>
<li>Turnover_Takeaway</li>
</ul>

<strong>Zone Entry/Exit details:</strong>
<ul>
<li>Zone_Entry</li>
<li>Zone_Exit</li>
<li>Zone_Keepin</li>
<li>Zone_Entryfailed</li>
<li>Zone_ExitFailed</li>
<li>Zone_KeepinFailed</li>
</ul>

<h4>Level 3: Secondary Details (shot types, pass types, etc.)</h4>

<strong>Shot types (for Shot_OnNetSaved, etc.):</strong>
<ul>
<li>Shot-Wrist</li>
<li>Shot-Slap</li>
<li>Shot-Backhand</li>
<li>Shot-Tip</li>
<li>Shot-Snap</li>
<li>Shot-WrapAround</li>
<li>Shot-Bat</li>
<li>Shot-Cradle</li>
<li>Shot-Poke</li>
</ul>

<strong>Pass types (for Pass_Completed, etc.):</strong>
<ul>
<li>Pass-Stretch</li>
<li>Pass-Rim/Wrap</li>
<li>Pass-Backhand</li>
<li>Pass-Forehand</li>
<li>Pass-Bank</li>
<li>Pass-Dump</li>
<li>Pass-Tipped</li>
<li>Pass-Lob</li>
</ul>

<strong>Zone Entry types:</strong>
<ul>
<li>ZoneEntry-Rush</li>
<li>ZoneEntry-Pass</li>
<li>ZoneEntry-DumpIn</li>
<li>ZoneEntry-Chip</li>
<li>ZoneEntry-FromExitClear</li>
<li>ZoneEntry-PassMiss/Misplay</li>
<li>ZoneEntry-OppTeam</li>
<li>ZoneEntry-Lob</li>
</ul>

<strong>Zone Exit types:</strong>
<ul>
<li>ZoneExit-Rush</li>
<li>ZoneExit-Pass</li>
<li>ZoneExit-Clear</li>
<li>ZoneExit-Chip</li>
<li>ZoneExit-PassMiss/Misplay</li>
<li>ZoneExit-OppTeam</li>
<li>ZoneExit-Lob</li>
<li>ZoneExit-CausedTurnover</li>
</ul>
<p>---</p>

<h2>Named Ranges</h2>
<p>The workbook uses <strong>59 named ranges</strong> for data validation:</p>

<table>
<thead><tr><th>Named Range</th><th>References</th><th>Purpose</th></tr></thead>
<tbody><tr><td>EventType</td><td>Lists!$A$2:$A$16</td><td>Main event type dropdown</td></tr><tr><td>Shot</td><td>Lists!$H$2:$H$1048576</td><td>Shot detail options</td></tr><tr><td>Pass</td><td>Lists!$I$2:$I$1048576</td><td>Pass detail options</td></tr><tr><td>Goal</td><td>Lists!$J$2:$J$1048576</td><td>Goal detail options</td></tr><tr><td>Turnover</td><td>Lists!$K$2:$K$1048576</td><td>Turnover detail options</td></tr><tr><td>Zone_Entry_Exit</td><td>Lists!$L$2:$L$1048576</td><td>Zone entry/exit options</td></tr><tr><td>Faceoff</td><td>Lists!$G$2:$G$1048576</td><td>Faceoff detail options</td></tr><tr><td>Save</td><td>Lists!$Q$2:$Q$1048576</td><td>Save detail options</td></tr><tr><td>Stoppage</td><td>Lists!$O$2:$O$1048576</td><td>Stoppage detail options</td></tr><tr><td>Shot_OnNetSaved</td><td>Lists!$AO$2:$AO$1048576</td><td>Shot type when saved</td></tr><tr><td>Shot_Missed</td><td>Lists!$AP$2:$AP$1048576</td><td>Shot type when missed</td></tr><tr><td>Shot_Blocked</td><td>Lists!$AQ$2:$AQ$1048576</td><td>Shot type when blocked</td></tr><tr><td>Goal_Scored</td><td>Lists!$AY$2:$AY$1048576</td><td>Goal type details</td></tr><tr><td>Pass_Completed</td><td>Lists!$R$2:$R$1048576</td><td>Pass type when completed</td></tr><tr><td>Pass_Missed</td><td>Lists!$S$2:$S$1048576</td><td>Pass type when missed</td></tr><tr><td>Zone_Entry</td><td>Lists!$X$2:$X$1048576</td><td>Zone entry method</td></tr><tr><td>Zone_Exit</td><td>Lists!$Y$2:$Y$1048576</td><td>Zone exit method</td></tr><tr><td>Turnover_Giveaway</td><td>Lists!$V$2:$V$1048576</td><td>Giveaway type</td></tr><tr><td>Turnover_Takeaway</td><td>Lists!$W$2:$W$1048576</td><td>Takeaway type</td></tr><tr><td>...</td><td>...</td><td>(59 total)</td></tr></tbody></table>
<hr>

<h2>Cross-Sheet Interactions</h2>

<h3>Events ↔ Shifts</h3>

<ol>
<li>1. <strong>shift_index lookup</strong>: Events can reference which shift they occurred during</li>
<li>2. <strong>Stoppage time</strong>: Shifts calculate total stoppage time from DeadIce/Timeout events</li>
<li>3. <strong>Period sync</strong>: Both sheets track period number</li>
</ul>

<h3>Events ↔ game_rosters</h3>

<ol>
<li>1. <strong>Player ID lookup</strong>: <code>=VLOOKUP(game_id&team&jersey, game_rosters!U:W, 3, FALSE)</code></li>
<li>2. <strong>Roster filter</strong>: game_rosters is populated via FILTER from external BLB_Tables.xlsx</li>
</ul>

<h3>Events ↔ Lists</h3>

<ol>
<li>1. <strong>Primary dropdown</strong>: event_type_ uses <code>EventType</code> named range</li>
<li>2. <strong>Cascading dropdowns</strong>: event_detail_ uses INDIRECT to reference named range matching event_type_</li>
<li>3. <strong>Secondary details</strong>: event_detail_2_ similarly cascades</li>
</ul>
<p>---</p>

<h2>Formula Logic Analysis</h2>

<h3>Key Patterns</h3>

<h4>1. Carryforward Pattern</h4>
Many columns use this pattern to carry values forward within the same event:
<pre><code class="language-excel">=IF(input&lt;&gt;"", input, IF(current_event=previous_event, previous_value, ""))
</code></pre>

<h4>2. Index Offset Pattern</h4>
Different index types have different offsets to ensure uniqueness:
<ul>
<li>event_index: +1000</li>
<li>linked_event_index: +9000</li>
<li>sequence_index: +5000</li>
<li>play_index: +6000</li>
</ul>

<h4>3. Array Formula Pattern (Linked Events)</h4>
<pre><code class="language-excel">=IFERROR(
    IF(O2&lt;&gt;"",
        O2,
        IF(OR($S2="",$T2=""),
            "",
            IF($T2&lt;&gt;"",
                FILTER(O:O, ($BT:$BT=$BT2)<em>($I:$I=$I2)</em>($T:$T=$T2)*($S:$S=MINIFS($S:$S,$T:$T,"="&$T2)),
                "")
            )
        )
    ),
    IF(O2="","","")
)&""
</code></pre>
This copies play details from the primary event to linked events.

<h4>4. Zone Perspective Flip</h4>
When tracking from away team perspective, zones are flipped:
<ul>
<li>Away team in "o" (offensive) zone → Home team in "d" (defensive) zone</li>
</ol>
<p>---</p>

<h2>Data Entry Workflow</h2>

<h3>Typical Event Entry Sequence</h3>

<ol>
<li>1. <strong>Set period start</strong> (usually GameStart or PeriodStart event)</li>
<li>2. <strong>For each event:</strong></li>
</ul>
   - Enter <code>1</code> in column A to create new event
   - Enter jersey number (I)
   - Enter team (W): h or a
   - Enter zone (J): o, d, or n
   - Select event type (K) from dropdown
   - Select event detail (L) from cascading dropdown
   - Select secondary detail (M) if applicable
   - Formulas auto-calculate: event_index, player_id, success, zones

<ol>
<li>3. <strong>For multi-player events (e.g., goal with assists):</strong></li>
</ol>
   - First row: Scorer with event_index_flag_=1
   - Second row: Primary assist (same event_index, different jersey)
   - Third row: Secondary assist (same event_index, different jersey)
   - All share same event_index via carryforward

<ol>
<li>4. <strong>Linked events:</strong></li>
</ol>
   - Enter linked_event_index_ (T) to reference another event
   - Array formulas copy play details from primary event

<h3>Shift Entry Sequence</h3>

<ol>
<li>1. <strong>For each line change:</strong></li>
</ol>
   - Enter shift_index (A)
   - Enter period (B)
   - Enter start/end times (C-F)
   - Enter start/stop types (G-H)
   - Enter all player jersey numbers (I-V)
   - Formulas auto-calculate: duration, strength, situation
<p>---</p>

<h2>Summary of Auto-Calculated Values</h2>

<h3>Events Sheet - Automatic</h3>

<table>
<thead><tr><th>Value</th><th>Source</th></tr></thead>
<tbody><tr><td>period</td><td>Increments on Intermission</td></tr><tr><td>event_index</td><td>From flag + MAX</td></tr><tr><td>player_id</td><td>VLOOKUP from roster</td></tr><tr><td>player_team</td><td>Derived from venue + role</td></tr><tr><td>event_successful</td><td>Based on event type/detail patterns</td></tr><tr><td>home/away zones</td><td>Flipped based on team perspective</td></tr><tr><td>side_of_puck</td><td>Offensive/Defensive based on role</td></tr><tr><td>video timestamps</td><td>From running_video_time</td></tr></tbody></table>
<h3>Shifts Sheet - Automatic</h3>

<table>
<thead><tr><th>Value</th><th>Source</th></tr></thead>
<tbody><tr><td>shift_duration</td><td>End - Start seconds</td></tr><tr><td>team_strength</td><td>COUNTIF of player cells</td></tr><tr><td>empty_net flags</td><td>Based on goalie cell empty</td></tr><tr><td>situation</td><td>Based on strength comparison</td></tr><tr><td>stoppage_time</td><td>SUMIFS of DeadIce/Timeout events</td></tr></tbody></table>
<hr>

<h2>Identified Pain Points for Tracker</h2>
<p>Based on this analysis, likely pain points:</p>

<ol>
<li>1. <strong>Many columns to fill</strong> - 72 columns, though ~20 are user input</li>
<li>2. <strong>Multi-row events</strong> - Goals require 3-4 rows for scorer + assists</li>
<li>3. <strong>Manual index management</strong> - Must set flags correctly</li>
<li>4. <strong>Cascading dropdowns</strong> - Three-level selection for each event</li>
<li>5. <strong>Cross-referencing</strong> - Linked events require manual index entry</li>
<li>6. <strong>No video integration</strong> - Video time must be manually tracked</li>
<li>7. <strong>Shift tracking separate</strong> - Must switch sheets for line changes</li>
<li>8. <strong>No undo</strong> - Excel mistakes require manual cleanup</li>
<li>9. <strong>Zone tracking</strong> - Must mentally flip zones for away team</li>
</ul>
<p>---</p>

<em>Document generated for BenchSight tracker development</em>

</div>
</main>
<footer>
  <div class="container">
    BenchSight Documentation • v16.08 • January 7, 2026
  </div>
</footer>
</body>
</html>
