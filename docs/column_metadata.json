{
  "event_id": {
    "desc": "Unique event identifier",
    "source": "derived",
    "formula": "EV{game_id}{period:02d}{event_index:03d}",
    "context": null
  },
  "shift_id": {
    "desc": "Unique shift identifier",
    "source": "derived",
    "formula": "SH{game_id}{shift_index:05d}",
    "context": null
  },
  "player_id": {
    "desc": "Unique player identifier",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "game_id": {
    "desc": "Game identifier from schedule",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "team_id": {
    "desc": "Team identifier",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "season_id": {
    "desc": "Season identifier",
    "source": "derived",
    "formula": "N{year1}{year2}F (Fall)",
    "context": null
  },
  "period_id": {
    "desc": "Period identifier",
    "source": "derived",
    "formula": "P{period:02d}",
    "context": null
  },
  "strength_id": {
    "desc": "Strength state identifier",
    "source": "derived",
    "formula": "STR{index:04d}",
    "context": null
  },
  "event_type": {
    "desc": "Type of event (Shot, Pass, Faceoff, etc.)",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "event_type_id": {
    "desc": "Event type dimension key",
    "source": "derived",
    "formula": "ET{index:04d}",
    "context": null
  },
  "event_detail": {
    "desc": "Specific event subtype",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "event_detail_id": {
    "desc": "Event detail dimension key",
    "source": "derived",
    "formula": "ED{index:03d}",
    "context": null
  },
  "event_detail_2": {
    "desc": "Secondary event detail (outcome, method)",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "event_successful": {
    "desc": "Success indicator (s/u/blank)",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "event_team_zone": {
    "desc": "Zone where event occurred (o/d/n)",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "player_role": {
    "desc": "Role of player in event",
    "source": "derived",
    "formula": null,
    "context": "event_player_1=primary actor, event_player_2=secondary, opp_player_1=primary opponent"
  },
  "event_player_1": {
    "desc": "Primary player performing action",
    "source": "explicit",
    "formula": null,
    "context": "Filter: player_role=\"event_player_1\" for goals/shots/passes"
  },
  "event_player_2": {
    "desc": "Secondary player (assist, target)",
    "source": "explicit",
    "formula": null,
    "context": "Filter: player_role=\"event_player_2\" for primary assists"
  },
  "event_player_3": {
    "desc": "Tertiary player (second assist)",
    "source": "explicit",
    "formula": null,
    "context": "Filter: player_role=\"event_player_3\" for secondary assists"
  },
  "opp_player_1": {
    "desc": "Primary opponent involved",
    "source": "explicit",
    "formula": null,
    "context": "Filter: player_role=\"opp_player_1\" for defensive stats"
  },
  "player_name": {
    "desc": "Player full name",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "player_number": {
    "desc": "Jersey number",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "player_game_number": {
    "desc": "Jersey number in specific game",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "is_goal": {
    "desc": "Goal scored flag",
    "source": "derived",
    "formula": "1 if event_type='Goal' AND event_detail='Goal_Scored' else 0",
    "context": "CRITICAL: Must use BOTH conditions. Shot_Goal is the shot, not the goal."
  },
  "is_assist": {
    "desc": "Assist recorded flag",
    "source": "derived",
    "formula": "1 if event_detail LIKE '%Assist%'",
    "context": "Filter: event_detail IN (AssistsPrimary, AssistsSecondary)"
  },
  "is_primary_assist": {
    "desc": "Primary assist flag",
    "source": "derived",
    "formula": "1 if event_detail='AssistsPrimary'",
    "context": "Filter: event_detail=\"AssistsPrimary\" AND player_role=\"event_player_1\""
  },
  "is_secondary_assist": {
    "desc": "Secondary assist flag",
    "source": "derived",
    "formula": "1 if event_detail='AssistsSecondary'",
    "context": "Filter: event_detail=\"AssistsSecondary\" AND player_role=\"event_player_1\""
  },
  "is_shot": {
    "desc": "Shot attempt flag",
    "source": "derived",
    "formula": "1 if event_type='Shot'",
    "context": null
  },
  "is_sog": {
    "desc": "Shot on goal flag",
    "source": "derived",
    "formula": "1 if is_shot AND (is_goal OR is_save)",
    "context": null
  },
  "is_blocked_shot": {
    "desc": "Blocked shot flag",
    "source": "derived",
    "formula": "1 if event_detail LIKE '%Block%'",
    "context": null
  },
  "is_missed_shot": {
    "desc": "Missed shot flag",
    "source": "derived",
    "formula": "1 if event_detail LIKE '%Miss%'",
    "context": null
  },
  "is_scoring_chance": {
    "desc": "Scoring chance flag",
    "source": "derived",
    "formula": "1 if shot from high-danger zone or quality play",
    "context": null
  },
  "is_high_danger": {
    "desc": "High danger chance flag",
    "source": "derived",
    "formula": "1 if shot from slot area",
    "context": null
  },
  "danger_level": {
    "desc": "Danger classification",
    "source": "derived",
    "formula": "Low/Medium/High based on shot location",
    "context": null
  },
  "gf_all": {
    "desc": "Goals for - all situations",
    "source": "calc",
    "formula": "COUNT goals while player on ice",
    "context": "All strength states"
  },
  "ga_all": {
    "desc": "Goals against - all situations",
    "source": "calc",
    "formula": "COUNT goals against while player on ice",
    "context": "All strength states"
  },
  "pm_all": {
    "desc": "Plus/minus - all situations",
    "source": "calc",
    "formula": "gf_all - ga_all",
    "context": null
  },
  "gf_ev": {
    "desc": "Goals for - even strength",
    "source": "calc",
    "formula": "COUNT goals while on ice at 5v5",
    "context": "Filter: strength=\"5v5\""
  },
  "ga_ev": {
    "desc": "Goals against - even strength",
    "source": "calc",
    "formula": "COUNT goals against at 5v5",
    "context": "Filter: strength=\"5v5\""
  },
  "pm_ev": {
    "desc": "Plus/minus - even strength",
    "source": "calc",
    "formula": "gf_ev - ga_ev",
    "context": null
  },
  "gf_pp": {
    "desc": "Goals for - power play",
    "source": "calc",
    "formula": "COUNT goals while team on PP",
    "context": "Filter: team_pp=1"
  },
  "ga_pp": {
    "desc": "Goals against - power play",
    "source": "calc",
    "formula": "COUNT goals against on PP",
    "context": "Filter: team_pp=1"
  },
  "gf_pk": {
    "desc": "Goals for - penalty kill",
    "source": "calc",
    "formula": "COUNT goals while team on PK",
    "context": "Filter: team_pk=1"
  },
  "ga_pk": {
    "desc": "Goals against - penalty kill",
    "source": "calc",
    "formula": "COUNT goals against on PK",
    "context": "Filter: team_pk=1"
  },
  "cf": {
    "desc": "Corsi for (shot attempts for)",
    "source": "calc",
    "formula": "shots + blocked + missed",
    "context": null
  },
  "ca": {
    "desc": "Corsi against (shot attempts against)",
    "source": "calc",
    "formula": "opponent cf",
    "context": null
  },
  "cf_pct": {
    "desc": "Corsi percentage",
    "source": "calc",
    "formula": "cf / (cf + ca) * 100",
    "context": ">50% = outshot opponent"
  },
  "ff": {
    "desc": "Fenwick for (unblocked attempts)",
    "source": "calc",
    "formula": "shots + missed (excludes blocked)",
    "context": null
  },
  "fa": {
    "desc": "Fenwick against",
    "source": "calc",
    "formula": "opponent ff",
    "context": null
  },
  "ff_pct": {
    "desc": "Fenwick percentage",
    "source": "calc",
    "formula": "ff / (ff + fa) * 100",
    "context": null
  },
  "player_rating": {
    "desc": "Player skill rating (2-6 scale)",
    "source": "explicit",
    "formula": null,
    "context": "2=beginner, 6=elite"
  },
  "opp_avg_rating": {
    "desc": "Average opponent rating faced",
    "source": "calc",
    "formula": "AVG(opponent_ratings) weighted by TOI",
    "context": "Quality of Competition proxy"
  },
  "team_rating_avg": {
    "desc": "Average teammate rating",
    "source": "calc",
    "formula": "AVG(teammate_ratings)",
    "context": "Quality of Teammates proxy"
  },
  "rating_advantage": {
    "desc": "Player rating minus opponent avg",
    "source": "calc",
    "formula": "player_rating - opp_avg_rating",
    "context": "+ve = playing vs weaker opponents"
  },
  "rating_differential": {
    "desc": "Team rating minus opponent team rating",
    "source": "calc",
    "formula": "team_rating_avg - opp_team_rating_avg",
    "context": null
  },
  "opp_multiplier": {
    "desc": "Opponent difficulty multiplier",
    "source": "calc",
    "formula": "opp_avg_rating / 4.0",
    "context": ">1 = harder opponents, <1 = easier"
  },
  "gf_adj": {
    "desc": "Goals for adjusted for opponent quality",
    "source": "calc",
    "formula": "gf_all * opp_multiplier",
    "context": "Inflates stats vs good teams"
  },
  "ga_adj": {
    "desc": "Goals against adjusted",
    "source": "calc",
    "formula": "ga_all / opp_multiplier",
    "context": "Deflates GA vs good teams"
  },
  "pm_adj": {
    "desc": "Plus/minus adjusted",
    "source": "calc",
    "formula": "gf_adj - ga_adj",
    "context": null
  },
  "cf_adj": {
    "desc": "Corsi for adjusted",
    "source": "calc",
    "formula": "cf * opp_multiplier",
    "context": null
  },
  "ca_adj": {
    "desc": "Corsi against adjusted",
    "source": "calc",
    "formula": "ca / opp_multiplier",
    "context": null
  },
  "cf_pct_adj": {
    "desc": "Adjusted corsi percentage",
    "source": "calc",
    "formula": "cf_adj / (cf_adj + ca_adj) * 100",
    "context": null
  },
  "expected_cf_pct": {
    "desc": "Expected CF% based on ratings",
    "source": "calc",
    "formula": "50 + (rating_differential * 5)",
    "context": "Baseline expectation"
  },
  "expected_pm": {
    "desc": "Expected +/- based on ratings",
    "source": "calc",
    "formula": "rating_advantage * 0.5 * shifts_played",
    "context": null
  },
  "cf_pct_vs_expected": {
    "desc": "CF% performance vs expectation",
    "source": "calc",
    "formula": "cf_pct - expected_cf_pct",
    "context": "+ve = overperforming"
  },
  "pm_vs_expected": {
    "desc": "+/- vs expectation",
    "source": "calc",
    "formula": "pm_all - expected_pm",
    "context": "+ve = overperforming"
  },
  "shift_duration": {
    "desc": "Shift length in seconds",
    "source": "calc",
    "formula": "shift_end_total_seconds - shift_start_total_seconds",
    "context": null
  },
  "toi": {
    "desc": "Time on ice in seconds",
    "source": "calc",
    "formula": "SUM(shift_duration)",
    "context": null
  },
  "toi_minutes": {
    "desc": "Time on ice in minutes",
    "source": "calc",
    "formula": "toi / 60",
    "context": null
  },
  "toi_pct": {
    "desc": "Percentage of game played",
    "source": "calc",
    "formula": "toi / game_duration * 100",
    "context": null
  },
  "event_start_min": {
    "desc": "Event start time - minutes",
    "source": "explicit",
    "formula": null,
    "context": "Countdown from period start"
  },
  "event_start_sec": {
    "desc": "Event start time - seconds",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "running_video_time": {
    "desc": "Cumulative game time in seconds",
    "source": "calc",
    "formula": "period_offset + (period_length - time_remaining)",
    "context": null
  },
  "shift_index": {
    "desc": "Sequential shift number in game",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "shift_start_type": {
    "desc": "How shift started",
    "source": "explicit",
    "formula": null,
    "context": "GameStart, Faceoff, OnTheFly, etc."
  },
  "shift_stop_type": {
    "desc": "How shift ended",
    "source": "explicit",
    "formula": null,
    "context": "Stoppage, Goal, Penalty, etc."
  },
  "logical_shift_number": {
    "desc": "Player consecutive shift number",
    "source": "calc",
    "formula": "ROW_NUMBER() per player ordered by time",
    "context": null
  },
  "cumulative_duration": {
    "desc": "Running TOI for player in game",
    "source": "calc",
    "formula": "SUM(shift_duration) up to current shift",
    "context": null
  },
  "strength": {
    "desc": "Strength state string",
    "source": "derived",
    "formula": "{home_strength}v{away_strength}",
    "context": "5v5, 5v4, 4v5, etc."
  },
  "home_team_strength": {
    "desc": "Home team skater count",
    "source": "explicit",
    "formula": null,
    "context": "3-6 skaters"
  },
  "away_team_strength": {
    "desc": "Away team skater count",
    "source": "explicit",
    "formula": null,
    "context": "3-6 skaters"
  },
  "home_team_pp": {
    "desc": "Home team on power play flag",
    "source": "derived",
    "formula": "1 if home_strength > away_strength",
    "context": null
  },
  "home_team_pk": {
    "desc": "Home team on penalty kill flag",
    "source": "derived",
    "formula": "1 if home_strength < away_strength",
    "context": null
  },
  "home_team_en": {
    "desc": "Home team empty net flag",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "away_team_en": {
    "desc": "Away team empty net flag",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "situation": {
    "desc": "Game situation description",
    "source": "derived",
    "formula": "Full Strength/Power Play/Penalty Kill/etc.",
    "context": null
  },
  "zone": {
    "desc": "Zone code (o/d/n)",
    "source": "explicit",
    "formula": null,
    "context": "o=offensive, d=defensive, n=neutral"
  },
  "zone_id": {
    "desc": "Zone dimension key",
    "source": "derived",
    "formula": "ZN{index:02d}",
    "context": null
  },
  "start_zone": {
    "desc": "Zone at shift start",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "end_zone": {
    "desc": "Zone at shift end",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "is_zone_entry": {
    "desc": "Zone entry event flag",
    "source": "derived",
    "formula": "1 if event_type='Zone_Entry_Exit' AND detail LIKE '%Entry%'",
    "context": null
  },
  "is_zone_exit": {
    "desc": "Zone exit event flag",
    "source": "derived",
    "formula": "1 if event_type='Zone_Entry_Exit' AND detail LIKE '%Exit%'",
    "context": null
  },
  "zone_entries": {
    "desc": "Count of zone entries",
    "source": "calc",
    "formula": "SUM(is_zone_entry)",
    "context": null
  },
  "zone_exits": {
    "desc": "Count of zone exits",
    "source": "calc",
    "formula": "SUM(is_zone_exit)",
    "context": null
  },
  "is_faceoff": {
    "desc": "Faceoff event flag",
    "source": "derived",
    "formula": "1 if event_type='Faceoff'",
    "context": null
  },
  "is_penalty": {
    "desc": "Penalty event flag",
    "source": "derived",
    "formula": "1 if event_type='Penalty'",
    "context": null
  },
  "is_save": {
    "desc": "Save event flag",
    "source": "derived",
    "formula": "1 if event_type='Save' OR event_detail LIKE '%Save%'",
    "context": null
  },
  "is_giveaway": {
    "desc": "Giveaway event flag",
    "source": "derived",
    "formula": "1 if event_type='Giveaway' OR turnover AND team possession lost",
    "context": null
  },
  "is_takeaway": {
    "desc": "Takeaway event flag",
    "source": "derived",
    "formula": "1 if event_type='Takeaway' OR turnover AND team gained possession",
    "context": null
  },
  "is_turnover": {
    "desc": "Any turnover flag",
    "source": "derived",
    "formula": "is_giveaway OR is_takeaway",
    "context": null
  },
  "is_rush": {
    "desc": "Rush play flag",
    "source": "derived",
    "formula": "1 if play_detail1 LIKE '%Rush%'",
    "context": null
  },
  "is_rebound": {
    "desc": "Rebound shot flag",
    "source": "derived",
    "formula": "1 if shot within 3 seconds of prior save",
    "context": null
  },
  "is_breakout": {
    "desc": "Breakout play flag",
    "source": "derived",
    "formula": "1 if play_detail1 LIKE '%Breakout%'",
    "context": null
  },
  "fo_won": {
    "desc": "Faceoffs won",
    "source": "calc",
    "formula": "COUNT where is_faceoff AND event_successful='s'",
    "context": null
  },
  "fo_lost": {
    "desc": "Faceoffs lost",
    "source": "calc",
    "formula": "COUNT where is_faceoff AND event_successful='u'",
    "context": null
  },
  "fo_pct": {
    "desc": "Faceoff win percentage",
    "source": "calc",
    "formula": "fo_won / (fo_won + fo_lost) * 100",
    "context": null
  },
  "saves": {
    "desc": "Saves made",
    "source": "calc",
    "formula": "COUNT(is_save)",
    "context": null
  },
  "goals_against": {
    "desc": "Goals allowed",
    "source": "calc",
    "formula": "COUNT goals while in net",
    "context": null
  },
  "save_pct": {
    "desc": "Save percentage",
    "source": "calc",
    "formula": "saves / (saves + goals_against)",
    "context": null
  },
  "gaa": {
    "desc": "Goals against average",
    "source": "calc",
    "formula": "goals_against / games_played",
    "context": null
  },
  "shutouts": {
    "desc": "Shutout count",
    "source": "calc",
    "formula": "COUNT games where goals_against=0",
    "context": null
  },
  "sequence_key": {
    "desc": "Links events in same play sequence",
    "source": "derived",
    "formula": "SQ{game_id}{seq_number:05d}",
    "context": null
  },
  "play_key": {
    "desc": "Links events in same possession",
    "source": "derived",
    "formula": "PL{game_id}{play_number:05d}",
    "context": null
  },
  "event_chain_key": {
    "desc": "Links related events",
    "source": "derived",
    "formula": "EC{game_id}{chain_id:06d}",
    "context": null
  },
  "shift_key": {
    "desc": "Links to shift record",
    "source": "derived",
    "formula": "SH{game_id}{shift_index:05d}",
    "context": null
  },
  "linked_event_key": {
    "desc": "Links shot to save/goal",
    "source": "derived",
    "formula": "LV{game_id}{video_time:05d}",
    "context": null
  },
  "home_team": {
    "desc": "Home team name",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "away_team": {
    "desc": "Away team name",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "player_team": {
    "desc": "Team the player is on",
    "source": "derived",
    "formula": "Lookup from roster",
    "context": null
  },
  "team_venue": {
    "desc": "Home or Away",
    "source": "derived",
    "formula": "'Home' if player_team=home_team else 'Away'",
    "context": null
  },
  "venue": {
    "desc": "Venue code (home/away)",
    "source": "derived",
    "formula": null,
    "context": null
  },
  "position": {
    "desc": "Player position code",
    "source": "explicit",
    "formula": null,
    "context": "F1, F2, F3, D1, D2, G"
  },
  "position_id": {
    "desc": "Position dimension key",
    "source": "derived",
    "formula": null,
    "context": null
  },
  "slot": {
    "desc": "Position slot on ice",
    "source": "derived",
    "formula": "forward_1, defense_2, etc.",
    "context": null
  },
  "qa_key": {
    "desc": "QA record unique key",
    "source": "derived",
    "formula": "QA_{type}_{game_id}",
    "context": null
  },
  "expected_goals": {
    "desc": "Expected goal count from source",
    "source": "explicit",
    "formula": null,
    "context": "From noradhockey.com"
  },
  "actual_goals": {
    "desc": "Goals counted by ETL",
    "source": "calc",
    "formula": "COUNT where event_type='Goal' AND event_detail='Goal_Scored'",
    "context": null
  },
  "match": {
    "desc": "Whether counts match",
    "source": "calc",
    "formula": "expected_goals == actual_goals",
    "context": null
  },
  "norad_goals": {
    "desc": "Official goals from NORAD",
    "source": "explicit",
    "formula": null,
    "context": "From noradhockey.com box score"
  },
  "norad_assists": {
    "desc": "Official assists from NORAD",
    "source": "explicit",
    "formula": null,
    "context": "From noradhockey.com box score"
  },
  "events_goals": {
    "desc": "Goals from our events",
    "source": "calc",
    "formula": "From fact_player_game_stats",
    "context": null
  },
  "events_assists": {
    "desc": "Assists from our events",
    "source": "calc",
    "formula": "From fact_player_game_stats",
    "context": null
  },
  "tier_id": {
    "desc": "Performance tier identifier",
    "source": "derived",
    "formula": "T{level:02d}",
    "context": "T01=Elite, T05=Poor"
  },
  "tier_name": {
    "desc": "Tier description",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "competition_tier_id": {
    "desc": "Opponent quality tier",
    "source": "derived",
    "formula": "Based on opp_avg_rating buckets",
    "context": null
  },
  "matchup_id": {
    "desc": "Matchup type identifier",
    "source": "derived",
    "formula": null,
    "context": null
  },
  "event_player_key": {
    "desc": "Unique player-event key",
    "source": "derived",
    "formula": "EP{game_id}_{event_id}_{player_index}",
    "context": null
  },
  "shift_player_key": {
    "desc": "Unique player-shift key",
    "source": "derived",
    "formula": "SP{shift_id}{venue}{slot}",
    "context": null
  },
  "tracking_event_key": {
    "desc": "Video tracking reference",
    "source": "derived",
    "formula": "TV{game_id}{video_frame}",
    "context": null
  },
  "goals": {
    "desc": "Goals scored",
    "source": "calc",
    "formula": "SUM(is_goal) where player_role='event_player_1'",
    "context": "Filter: player_role=\"event_player_1\" AND event_type=\"Goal\" AND event_detail=\"Goal_Scored\""
  },
  "assists": {
    "desc": "Assists recorded",
    "source": "calc",
    "formula": "SUM where event_detail LIKE '%Assist%'",
    "context": "Filter: event_detail IN (AssistsPrimary, AssistsSecondary)"
  },
  "points": {
    "desc": "Total points (G+A)",
    "source": "calc",
    "formula": "goals + assists",
    "context": null
  },
  "shots": {
    "desc": "Shot attempts",
    "source": "calc",
    "formula": "SUM(is_shot)",
    "context": null
  },
  "shots_on_goal": {
    "desc": "Shots on goal",
    "source": "calc",
    "formula": "SUM(is_sog)",
    "context": null
  },
  "shooting_pct": {
    "desc": "Shooting percentage",
    "source": "calc",
    "formula": "goals / shots_on_goal * 100",
    "context": null
  },
  "pim": {
    "desc": "Penalty minutes",
    "source": "calc",
    "formula": "SUM(penalty_minutes)",
    "context": null
  },
  "games_played": {
    "desc": "Games played",
    "source": "calc",
    "formula": "COUNT DISTINCT game_id",
    "context": null
  },
  "check_date": {
    "desc": "When QA check was run",
    "source": "derived",
    "formula": "datetime.now()",
    "context": null
  },
  "source": {
    "desc": "Data source reference",
    "source": "explicit",
    "formula": null,
    "context": null
  },
  "event_count": {
    "desc": "Number of events in shift",
    "source": "calc",
    "formula": "COUNT events during shift",
    "context": null
  }
}