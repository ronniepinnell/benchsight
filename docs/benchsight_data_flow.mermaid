flowchart TB
    %% ============================================
    %% BENCHSIGHT ETL DATA FLOW
    %% Version: 13.18 | January 7, 2026
    %% ============================================

    subgraph Input["Input Data"]
        BLB[BLB_Tables.xlsx]
        TRACK[tracking.xlsx x4 games]
        ROSTER[roster.json x4 games]
    end

    subgraph Phase1["Phase 1: Load Master Data"]
        P1[Load BLB_Tables.xlsx]
        P1 --> DIM[Create 34 Dimensions]
    end

    subgraph Phase2["Phase 2: Process Games"]
        P2[Load tracking.xlsx]
        P2 --> FET[fact_event_players<br/>11,181 rows]
        P2 --> FSH[fact_shifts<br/>398 rows]
        ROSTER --> FGR[fact_gameroster<br/>88 rows]
    end

    subgraph Phase3["Phase 3: Derive Tables"]
        FET --> FE[fact_events<br/>5,831 rows]
        FE --> FF[fact_faceoffs<br/>171]
        FE --> FR[fact_rushes<br/>314]
        FE --> FZE[fact_zone_entries<br/>508]
        FE --> FSV[fact_saves<br/>212]
        FE --> FP[fact_penalties<br/>20]
    end

    subgraph Phase4["Phase 4: Advanced"]
        FE --> FSQ[fact_sequences]
        FE --> FPL[fact_plays]
        FSH --> FSP[fact_shift_players]
    end

    subgraph Output["Output: 62 Tables"]
        OUT[data/output/*.csv]
    end

    Input --> Phase1
    Phase1 --> Phase2
    Phase2 --> Phase3
    Phase3 --> Phase4
    Phase4 --> Output
