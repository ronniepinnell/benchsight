[12:49:09] INFO: Loading dim_player...
[12:49:09] INFO:   Removed 7 CSAH columns from dim_player
[12:49:09] INFO:   Saved dim_player: 336 rows, 20 cols
[12:49:09] INFO: Loading dim_team...
[12:49:09] INFO:   Filtered dim_team to NORAD only: 13 -> 13 rows
[12:49:09] INFO:   Removed csah_team column from dim_team
[12:49:09] INFO:   Saved dim_team: 13 rows, 13 cols
[12:49:09] INFO: Loading dim_league...
[12:49:09] INFO:   Saved dim_league: 2 rows, 2 cols
[12:49:09] INFO: Loading dim_season...
[12:49:09] INFO:   Saved dim_season: 5 rows, 9 cols
[12:49:09] INFO: Loading dim_schedule...
[12:49:09] INFO:   Removed 2 video/team_game_id columns from dim_schedule
[12:49:09] INFO:   Saved dim_schedule: 616 rows, 37 cols
[12:49:09] INFO: Loading dim_playerurlref...
[12:49:09] INFO:   Saved dim_playerurlref: 550 rows, 3 cols
[12:49:09] INFO: Loading dim_randomnames...
[12:49:10] INFO:   Saved dim_randomnames: 486 rows, 5 cols
[12:49:10] INFO: Loading dim_event_type...
[12:49:10] INFO:   Saved dim_event_type: 23 rows, 7 cols
[12:49:10] INFO: Loading dim_event_detail...
[12:49:10] INFO:   Saved dim_event_detail: 55 rows, 11 cols
[12:49:10] INFO: Loading dim_event_detail_2...
[12:49:10] INFO:   Saved dim_event_detail_2: 176 rows, 12 cols
[12:49:10] INFO: Loading dim_play_detail...
[12:49:10] INFO:   Saved dim_play_detail: 111 rows, 6 cols
[12:49:10] INFO: Loading dim_play_detail_2...
[12:49:10] INFO:   Renamed columns for dim_play_detail_2: ['play_detail_id', 'play_detail_code', 'play_detail_name']
[12:49:10] INFO:   Saved dim_play_detail_2: 111 rows, 6 cols
[12:49:10] INFO: Loading fact_gameroster...
[12:49:11] INFO:   Enhancing fact_gameroster...
[12:49:11] INFO:     season_id from schedule: 14704/14704 mapped
[12:49:12] INFO:     Deduped on (game_id, player_id): 14704 -> 14702
[12:49:12] INFO:     Enhanced: 14702 rows, 24 cols
[12:49:12] INFO:   Saved fact_gameroster: 14,702 rows, 24 cols
[12:49:12] INFO: Loading fact_leadership...
[12:49:12] INFO:   Saved fact_leadership: 28 rows, 9 cols
[12:49:12] INFO: Loading fact_registration...
[12:49:12] INFO:   Deduped on player_season_registration_id: 191 -> 190
[12:49:12] INFO:   Saved fact_registration: 190 rows, 18 cols
[12:49:12] INFO: Loading fact_draft...
[12:49:12] INFO:   Saved fact_draft: 160 rows, 14 cols
[12:49:12] INFO: Built lookup with 27042 mappings
[12:49:12] WARN: Found 25 conflicts (duplicate numbers on different teams)
[12:49:12] WARN:   Conflict: ('10031', 'HollowBrook', '11') -> P100084, P100029
[12:49:12] WARN:   Conflict: ('13433', 'HollowBrook', '22') -> P100325, P100097
[12:49:12] WARN:   Conflict: ('13435', 'HollowBrook', '22') -> P100325, P100097
[12:49:12] WARN:   Conflict: ('13446', 'HollowBrook', '22') -> P100325, P100097
[12:49:12] WARN:   Conflict: ('13448', 'HollowBrook', '22') -> P100325, P100097
[12:49:12] INFO: Valid games: ['18969', '18977', '18981', '18987', '19038']
[12:49:12] INFO: Excluded games: ['18965', '19032', '18993', '18955', '18959', '18991', '18998', '19007', '19009', '19014', '19020', '19026', '19036']
[12:49:12] INFO: Loaded dim_schedule for venue validation: 616 games
[12:49:12] INFO: Using parallel game loading (5 games)...
[12:49:15] INFO:   Parallel loading complete: 5 event sets, 5 shift sets
[12:49:15] INFO:   Calculating derived columns from minimal input...
[12:49:16] INFO:     Detected 3 pressure situations from XY distance
[12:49:16] INFO:     Calculated 11 columns: team_venue, team_venue_abv, player_team, home_team_zone, away_team_zone, player_role, side_of_puck, role_number, role_abrev, play_detail_2...
[12:49:16] INFO:   is_goal flag: 18 goals identified
[12:49:16] INFO: Generating sequences and plays...
[12:49:16] INFO:   sequence_key: 11509/11516
[12:49:16] INFO:   play_key: 11509/11516
[12:49:16] INFO: Standardizing play_detail values...
[12:49:16] INFO:   Dropped 5 index columns (keys retained)
[12:49:16] INFO: Adding FK columns...
[12:49:16] INFO:   Added 9 FK columns
[12:49:16] INFO: Adding event_chain_key...
[12:49:16] INFO:   event_chain_key: 11516/11516
[12:49:16] INFO:   Removed 3 unused flag columns: ['event_index_flag', 'sequence_index_flag', 'play_index_flag']
[12:49:16] INFO:   Removed 3 duplicate columns: ['team', 'Type', 'play_detail2']
[12:49:16] INFO: 
Combined events: 11,516 rows, 90 cols, 5 games
[12:49:16] INFO:   player_id linked: 11490/11516
[12:49:16] INFO: Combined shifts: 445 rows, 5 games
[12:49:16] INFO: dim_player_role: 14 rows
[12:49:16] INFO: dim_position: 6 rows
[12:49:16] INFO: dim_zone: 3 rows
[12:49:16] INFO: dim_period: 5 rows
[12:49:16] INFO: dim_venue: 2 rows
[12:49:16] INFO: dim_event_type: using BLB_Tables data
[12:49:16] INFO: dim_event_detail: using BLB_Tables data
[12:49:16] INFO: dim_event_detail_2: using BLB_Tables data
[12:49:16] INFO: dim_success: 3 rows
[12:49:16] INFO: dim_shot_type: 6 rows
[12:49:16] INFO: dim_pass_type: 8 rows
[12:49:16] INFO: dim_zone_entry_type: 13 rows
[12:49:16] INFO: dim_zone_exit_type: 12 rows
[12:49:17] INFO: dim_stoppage_type: 4 rows
[12:49:17] INFO: dim_giveaway_type: 13 rows (6 bad, 7 neutral)
[12:49:17] INFO: dim_takeaway_type: 8 rows
[12:49:17] INFO: dim_play_detail: using BLB_Tables data
[12:49:17] INFO: dim_play_detail_2: using BLB_Tables data
[12:49:17] INFO: Creating fact_events...
[12:49:18] INFO:   fact_events: 5,965 rows, 72 cols
[12:49:18] INFO:   FKs: period_id=5965, event_type_id=5964, event_detail_id=4811
[12:49:18] INFO: Creating fact_tracking...
[12:49:18] INFO:   fact_tracking: 5,965 rows, 19 cols
[12:49:18] INFO: Creating fact_shifts...
[12:49:18] INFO:   fact_shifts: 445 rows
[12:49:18] INFO: Creating fact_shift_players...
[12:49:18] INFO:   fact_shift_players: 5,175 rows
[12:49:18] INFO:   player_id linked: 5171/5175
[12:49:18] INFO: Enhancing fact_event_players: 11516 rows, 89 cols
[12:49:18] INFO: Enhancing fact_events: 5965 rows, 68 cols
[12:49:18] INFO:   Adding shift_id FK (matching events to shifts)...
[12:49:18] INFO:     fact_event_players.shift_id: 643/11516 (5.6%)
[12:49:18] INFO:     fact_events.shift_id: 276/5965 (4.6%)
[12:49:18] INFO:   Adding player_name...
[12:49:18] INFO:   Adding season_id...
[12:49:18] INFO:   Adding position_id...
[12:49:18] INFO:   Adding shot_type_id...
[12:49:18] INFO:   Adding zone_entry_type_id...
[12:49:18] INFO:   Adding zone_exit_type_id...
[12:49:18] INFO:   Adding stoppage_type_id...
[12:49:18] INFO:   Adding giveaway_type_id...
[12:49:18] INFO:   Adding takeaway_type_id...
[12:49:18] INFO:   Adding turnover_type_id (placeholder - linked in post-ETL)...
[12:49:18] INFO:   Adding pass_type_id...
[12:49:18] INFO:   Adding time_bucket_id...
[12:49:18] INFO:   Adding strength_id...
[12:49:18] INFO:   Adding player_rating...
[12:49:18] INFO:   Dropping: role_number, role_abrev, team_venue_abv...
[12:49:19] INFO:   ✓ fact_event_players: 11516 rows, 101 cols
[12:49:19] INFO:   Enhancing fact_events from tracking...
[12:49:19] INFO:   ✓ fact_events: 5965 rows, 83 cols
[12:49:19] INFO:   Fill rates:
[12:49:19] INFO:     player_name: 11490/11516 (99.8%)
[12:49:19] INFO:     season_id: 11516/11516 (100.0%)
[12:49:19] INFO:     position_id: 11490/11516 (99.8%)
[12:49:19] INFO:     shot_type_id: 953/11516 (8.3%)
[12:49:19] INFO:     zone_entry_type_id: 1381/11516 (12.0%)
[12:49:19] INFO:     zone_exit_type_id: 859/11516 (7.5%)
[12:49:19] INFO:     stoppage_type_id: 171/11516 (1.5%)
[12:49:19] INFO:     giveaway_type_id: 1066/11516 (9.3%)
[12:49:19] INFO:     takeaway_type_id: 297/11516 (2.6%)
[12:49:19] INFO:     turnover_type_id: 0/11516 (0.0%)
[12:49:19] INFO:     pass_type_id: 2210/11516 (19.2%)
[12:49:19] INFO:     time_bucket_id: 11511/11516 (100.0%)
[12:49:19] INFO:     strength_id: 11516/11516 (100.0%)
[12:49:19] INFO:     player_rating: 11490/11516 (99.8%)
[12:49:19] INFO: Enhancing fact_player_event_chains...
[12:49:19] INFO: Enhancing fact_tracking...
[12:49:19] INFO:   ✓ fact_tracking: 5965 rows, 21 cols
[12:49:19] INFO: Building fact_cycle_events with zone inference...
[12:49:19] INFO:   ✓ fact_cycle_events: 37 rows, 22 columns
[12:49:19] INFO:   ✓ Updated is_cycle flag: 472 tracking rows, 224 event rows
[12:49:19] INFO:   Done enhancing derived tables
[12:49:19] INFO: Enhancing 5965 events...
[12:49:19] INFO:   Adding shooter, shot_blocker, and goalie columns for shot events...
[12:49:19] INFO:     Added shooter/goalie/blocker info: 457 shots (112 blocked, 230 saved, 18 goals)
[12:49:19] INFO:   Adding context columns...
[12:49:21] INFO:     Context columns added: 43
[12:49:21] INFO:   Adding segment numbers for plays, sequences, chains, and linked events...
[12:49:22] INFO:     play_segment_number: 5959 events have positions
[12:49:22] INFO:     sequence_segment_number: 5959 events have positions
[12:49:24] INFO:     event_chain_segment_number: 5965 events have positions
[12:49:24] INFO:     linked_event_segment_number: 669 events have positions
[12:49:24] INFO:   ✓ fact_events: 5965 rows, 172 cols
[12:49:24] INFO:     Flags: rush=103, controlled_entry=349, carried_entry=276, sog=230
[12:49:24] INFO: Aggregating 5965 events into sequences...
[12:49:25] INFO:   ✓ fact_sequences: 362 rows, 38 cols
[12:49:25] INFO:     Goals: 18, Avg events/seq: 16.5
[12:49:25] INFO: Aggregating 5965 events into plays...
[12:49:26] INFO:   ✓ fact_plays: 2122 rows, 39 cols
[12:49:26] INFO:     Goals: 18, Shots: 339, Avg events/play: 2.8
[12:49:26] INFO:   ✓ dim_danger_level: 3 rows
[12:49:26] INFO:   ✓ fact_rushes: 103 rows
[12:49:26] INFO:   Removed 18 all-null columns from fact_breakouts: ['shot_type_id', 'stoppage_type_id', 'giveaway_type_id', 'takeaway_type_id', 'pass_type_id', 'shooter_player_id', 'shooter_name', 'shooter_rating', 'shot_blocker_player_id', 'shot_blocker_name']...
[12:49:26] INFO:   ✓ fact_breakouts: 488 rows, 156 columns
[12:49:26] INFO:   ✓ fact_zone_entries: 511 rows
[12:49:26] INFO:   ✓ fact_zone_exits: 488 rows
[12:49:26] INFO:   ✓ fact_scoring_chances_detailed: 248 rows
[12:49:26] INFO:   ✓ fact_high_danger_chances: 23 rows
[12:49:26] INFO:   Calculating time_from_zone_entry for saves...
[12:49:26] INFO:   ✓ fact_saves: 215 rows
[12:49:26] INFO:   ✓ fact_turnovers_detailed: 772 rows
[12:49:26] INFO:   Removed 27 all-null columns from fact_faceoffs: ['event_detail_2', 'event_detail_2_id', 'event_successful', 'success_id', 'play_detail_2', 'play_detail_successful', 'shot_type_id', 'zone_entry_type_id', 'zone_exit_type_id', 'stoppage_type_id']...
[12:49:27] INFO:   ✓ fact_faceoffs: 170 rows, 147 columns
[12:49:27] INFO:   ✓ fact_penalties: 11 rows
[12:49:27] INFO: Enhancing 445 shifts...
[12:49:27] INFO:   Adding team ratings (excluding goalies)...
[12:49:27] INFO:   Team ratings: home_avg=nan, away_avg=nan, differential=nan
[12:49:27] INFO:   Calculating game state (leading/trailing/tied)...
[12:49:27] INFO:   Game states: tied=245, home_leading=119, home_trailing=81
[12:49:27] INFO:   ✓ fact_shifts: 445 rows, 146 cols
[12:49:27] INFO:   ✓ Player IDs, plus/minus (5 types), shift stats added
[12:49:27] INFO: Enhancing 5175 shift-player records...
[12:49:27] INFO:   Source: fact_shifts has 125 columns
[12:49:27] INFO:   Pass 1: Pulling stats from fact_shifts...
[12:49:27] WARN:   Missing columns in fact_shifts (will be skipped): ['home_avg_rating', 'home_min_rating', 'home_max_rating', 'away_avg_rating', 'away_min_rating', 'away_max_rating', 'rating_differential']
[12:49:27] INFO:     Pulled 72 columns from fact_shifts
[12:49:27] INFO:   Pass 1B: Calculating logical shifts...
[12:49:27] INFO:     Logical shifts: max per player-game = 14, avg = 8.5
[12:49:27] INFO:   Pass 2: Adding player ratings and adjusted stats...
[12:49:27] INFO:   Pass 2B: Calculating adjusted stats...
[12:49:27] INFO:     Performance distribution: Over=1213, Expected=2762, Under=1200
[12:49:27] INFO:   ✓ fact_shift_players: 5175 rows, 112 columns
[12:49:27] INFO:   ✓ Enhanced from 9 to 112 columns (v19.00 fix)
[12:49:27] INFO: Building player game positions from 5175 shift-player records...
[12:49:27] INFO:   ✓ fact_player_game_position: 134 rows
[12:49:28] INFO:   ✓ Updated 11 positions in fact_gameroster from shift data
[12:49:28] INFO: 
[1] Table existence check:
[12:49:28] INFO:   ✓ dim_player: 336 rows
[12:49:28] INFO:   ✓ dim_team: 13 rows
[12:49:28] INFO:   ✓ dim_league: 2 rows
[12:49:28] INFO:   ✓ dim_season: 5 rows
[12:49:28] INFO:   ✓ dim_schedule: 616 rows
[12:49:28] INFO:   ✓ dim_player_role: 14 rows
[12:49:28] INFO:   ✓ dim_position: 6 rows
[12:49:28] INFO:   ✓ dim_zone: 3 rows
[12:49:28] INFO:   ✓ dim_period: 5 rows
[12:49:28] INFO:   ✓ dim_venue: 2 rows
[12:49:28] INFO:   ✓ fact_gameroster: 14,702 rows
[12:49:28] INFO:   ✓ fact_events: 5,965 rows
[12:49:28] INFO:   ✓ fact_event_players: 11,516 rows
[12:49:28] INFO:   ✓ fact_tracking: 5,965 rows
[12:49:28] INFO:   ✓ fact_shifts: 445 rows
[12:49:28] INFO:   ✓ fact_shift_players: 5,175 rows
[12:49:28] INFO:   ✓ fact_shifts: 445 rows
[12:49:28] INFO:   ✓ fact_draft: 160 rows
[12:49:28] INFO:   ✓ fact_registration: 190 rows
[12:49:28] INFO:   ✓ fact_leadership: 28 rows
[12:49:28] INFO: 
[2] Game coverage (tracking tables):
[12:49:28] INFO:   ✓ fact_events: all 5 games present
[12:49:28] INFO:   ✓ fact_shifts: all 5 games present
[12:49:28] INFO:   ✓ fact_shift_players: all 5 games present
[12:49:28] INFO: 
[3] Primary key integrity:
[12:49:28] INFO:   ✓ dim_player.player_id: P100017
[12:49:28] INFO:   ✓ dim_team.team_id: N10001
[12:49:28] INFO:   ✓ dim_league.league_id: N
[12:49:28] INFO:   ✓ dim_season.season_id: N20212022F
[12:49:28] INFO:   ✓ dim_schedule.game_id: 10063
[12:49:28] INFO:   ✓ fact_events.event_id: EV1896901496
[12:49:28] INFO:   ✓ fact_shifts.shift_id: SH1903800001
[12:49:28] INFO:   ✓ fact_shift_players.shift_player_id: SP1896900001P100001
[12:49:28] INFO: 
[4] Player ID linkage:
[12:49:28] INFO:   ✓ fact_event_players: 11,490/11,516 (99.8%)
[12:49:28] INFO:   ✓ fact_shift_players: 5,171/5,175 (99.9%)
[12:49:28] INFO:   ✓ fact_gameroster: 14,702/14,702 (100.0%)
[12:49:28] INFO: 
[5] No underscore columns check:
[12:49:28] INFO:   ✓ dim_period: clean
[12:49:28] INFO:   ✓ fact_shifts: clean
[12:49:28] INFO:   ✓ fact_registration: clean
[12:49:28] INFO:   ✓ dim_shot_type: clean
[12:49:28] INFO:   ✓ dim_danger_level: clean
[12:49:28] INFO:   ✓ dim_team: clean
[12:49:28] INFO:   ✓ dim_player: clean
[12:49:28] INFO:   ✓ fact_events: clean
[12:49:28] INFO:   ✓ dim_play_detail_2: clean
[12:49:28] INFO:   ✓ dim_pass_type: clean
[12:49:28] INFO:   ✓ fact_saves: clean
[12:49:28] INFO:   ✓ dim_takeaway_type: clean
[12:49:28] INFO:   ✓ dim_league: clean
[12:49:28] INFO:   ✓ fact_faceoffs: clean
[12:49:28] INFO:   ✓ fact_gameroster: clean
[12:49:28] INFO:   ✓ fact_breakouts: clean
[12:49:28] INFO:   ✓ dim_schedule: clean
[12:49:28] INFO:   ✓ dim_zone_entry_type: clean
[12:49:28] INFO:   ✓ fact_rushes: clean
[12:49:28] INFO:   ✓ fact_shift_players: clean
[12:49:28] INFO:   ✓ fact_sequences: clean
[12:49:28] INFO:   ✓ fact_high_danger_chances: clean
[12:49:28] INFO:   ✓ dim_zone_exit_type: clean
[12:49:28] INFO:   ✓ fact_event_players: clean
[12:49:28] INFO:   ✓ dim_shift_start_type: clean
[12:49:28] INFO:   ✓ fact_tracking: clean
[12:49:28] INFO:   ✓ dim_play_detail: clean
[12:49:28] INFO:   ✓ fact_cycle_events: clean
[12:49:28] INFO:   ✓ dim_event_detail: clean
[12:49:28] INFO:   ✓ fact_scoring_chances_detailed: clean
[12:49:28] INFO:   ✓ dim_shift_stop_type: clean
[12:49:28] INFO:   ✓ dim_event_type: clean
[12:49:28] INFO:   ✓ fact_leadership: clean
[12:49:28] INFO:   ✓ fact_draft: clean
[12:49:28] INFO:   ✓ fact_plays: clean
[12:49:28] INFO:   ✓ dim_playerurlref: clean
[12:49:28] INFO:   ✓ dim_venue: clean
[12:49:28] INFO:   ✓ fact_penalties: clean
[12:49:28] INFO:   ✓ fact_zone_exits: clean
[12:49:28] INFO:   ✓ dim_stoppage_type: clean
[12:49:28] INFO:   ✓ dim_position: clean
[12:49:28] INFO:   ✓ fact_turnovers_detailed: clean
[12:49:28] INFO:   ✓ dim_zone: clean
[12:49:28] INFO:   ✓ dim_player_role: clean
[12:49:28] INFO:   ✓ dim_success: clean
[12:49:28] INFO:   ✓ dim_giveaway_type: clean
[12:49:28] INFO:   ✓ dim_randomnames: clean
[12:49:28] INFO:   ✓ fact_player_game_position: clean
[12:49:28] INFO:   ✓ dim_event_detail_2: clean
[12:49:28] INFO:   ✓ dim_situation: clean
[12:49:28] INFO:   ✓ fact_zone_entries: clean
[12:49:28] INFO:   ✓ dim_season: clean
[12:49:28] INFO: 
[6] Referential integrity:
[12:49:28] INFO:   ✓ All event games exist in schedule
[12:49:28] INFO: Tables: 52
[12:49:28] INFO: Total rows: 52,446
[12:49:28] INFO: Warnings: 7
[12:49:28] INFO: Errors: 0
[12:49:28] INFO: Issues for review: 0
[12:49:28] INFO: 
✓ ALL VALIDATIONS PASSED