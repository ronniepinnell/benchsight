[23:35:24] INFO: Loading dim_player...
[23:35:25] INFO:   Removed 7 CSAH columns from dim_player
[23:35:25] INFO:   Saved dim_player: 337 rows, 20 cols
[23:35:25] INFO: Loading dim_team...
[23:35:25] INFO:   Filtered dim_team to NORAD only: 26 -> 17 rows
[23:35:25] INFO:   Removed csah_team column from dim_team
[23:35:25] INFO:   Saved dim_team: 17 rows, 13 cols
[23:35:25] INFO: Loading dim_league...
[23:35:25] INFO:   Saved dim_league: 2 rows, 2 cols
[23:35:25] INFO: Loading dim_season...
[23:35:26] INFO:   Saved dim_season: 9 rows, 8 cols
[23:35:26] INFO: Loading dim_schedule...
[23:35:26] INFO:   Removed 7 video/team_game_id columns from dim_schedule
[23:35:26] INFO:   Saved dim_schedule: 572 rows, 37 cols
[23:35:26] INFO: Loading dim_playerurlref...
[23:35:26] INFO:   Saved dim_playerurlref: 550 rows, 3 cols
[23:35:26] INFO: Loading dim_randomnames...
[23:35:27] INFO:   Saved dim_randomnames: 486 rows, 5 cols
[23:35:27] INFO: Loading dim_event_type...
[23:35:27] INFO:   Saved dim_event_type: 23 rows, 7 cols
[23:35:27] INFO: Loading dim_event_detail...
[23:35:27] INFO:   Saved dim_event_detail: 55 rows, 11 cols
[23:35:27] INFO: Loading dim_event_detail_2...
[23:35:28] INFO:   Saved dim_event_detail_2: 176 rows, 12 cols
[23:35:28] INFO: Loading dim_play_detail...
[23:35:28] INFO:   Saved dim_play_detail: 111 rows, 6 cols
[23:35:28] INFO: Loading dim_play_detail_2...
[23:35:29] INFO:   Renamed columns for dim_play_detail_2: ['play_detail_id', 'play_detail_code', 'play_detail_name']
[23:35:29] INFO:   Saved dim_play_detail_2: 111 rows, 6 cols
[23:35:29] INFO: Loading fact_gameroster...
[23:35:32] INFO:   Enhancing fact_gameroster...
[23:35:32] INFO:     Deduped on (game_id, player_id): 14726 -> 14724
[23:35:32] INFO:     Enhanced: 14724 rows, 24 cols
[23:35:32] INFO:   Saved fact_gameroster: 14,724 rows, 24 cols
[23:35:32] INFO: Loading fact_leadership...
[23:35:33] INFO:   Saved fact_leadership: 28 rows, 9 cols
[23:35:33] INFO: Loading fact_registration...
[23:35:33] INFO:   Deduped on player_season_registration_id: 191 -> 190
[23:35:33] INFO:   Saved fact_registration: 190 rows, 18 cols
[23:35:33] INFO: Loading fact_draft...
[23:35:33] INFO:   Saved fact_draft: 160 rows, 14 cols
[23:35:34] INFO: Built lookup with 27386 mappings
[23:35:34] WARN: Found 128 conflicts (duplicate numbers on different teams)
[23:35:34] WARN:   Conflict: ('10031', 'HollowBrook', '11') -> P100084 vs P100029
[23:35:34] WARN:   Conflict: ('13241', 'Triple J', 'nan') -> P100206 vs P100010
[23:35:34] WARN:   Conflict: ('13241', 'Triple J', 'nan') -> P100010 vs P100271
[23:35:34] WARN:   Conflict: ('13241', 'Platinum', 'nan') -> P100280 vs P100055
[23:35:34] WARN:   Conflict: ('13241', 'Platinum', 'nan') -> P100055 vs P100304
[23:35:34] INFO: Valid games: ['18969', '18977', '18981', '18987']
[23:35:34] INFO: Excluded games: ['18993', '18965', '19032']
[23:35:34] INFO: Loaded dim_schedule for venue validation: 572 games
[23:35:34] INFO: 
Loading game 18969 from 18969_tracking.xlsx...
[23:35:35] INFO:   events: 3142 raw rows, dropped 13 underscore cols
[23:35:35] INFO:   events: 3142 valid rows (by event_index)
[23:35:35] INFO:   shifts: 98 raw rows, dropped 0 underscore cols
[23:35:35] INFO:   shifts: 98 valid rows (by shift_index)
[23:35:35] INFO: 
Loading game 18977 from 18977_tracking.xlsx...
[23:35:36] INFO:   events: 2526 raw rows, dropped 13 underscore cols
[23:35:36] INFO:   events: 2526 valid rows (by event_index)
[23:35:36] INFO:   shifts: 88 raw rows, dropped 0 underscore cols
[23:35:36] INFO:   shifts: 88 valid rows (by shift_index)
[23:35:36] INFO: 
Loading game 18981 from 18981_tracking.xlsx...
[23:35:37] INFO:   events: 2423 raw rows, dropped 13 underscore cols
[23:35:37] INFO:   events: 2423 valid rows (by event_index)
[23:35:37] INFO:   shifts: 106 raw rows, dropped 0 underscore cols
[23:35:37] INFO:   shifts: 106 valid rows (by shift_index)
[23:35:37] INFO: 
Loading game 18987 from 18987_tracking.xlsx...
[23:35:38] INFO:   events: 3064 raw rows, dropped 13 underscore cols
[23:35:38] INFO:   events: 3064 valid rows (by event_index)
[23:35:38] INFO:   shifts: 107 raw rows, dropped 0 underscore cols
[23:35:38] INFO:   shifts: 107 valid rows (by shift_index)
[23:35:38] INFO:   Calculating derived columns from minimal input...
[23:35:38] INFO:     Calculated 18 columns: time_start_total_seconds, time_end_total_seconds, duration, event_running_start, event_running_end, period_start_total_running_seconds, running_video_time, running_intermission_duration, team_venue, team_venue_abv...
[23:35:38] INFO:   Normalized 1139 'Rush' → 'Carried' in event_detail_2
[23:35:38] INFO:   is_goal flag: 16 goals identified
[23:35:38] INFO: Generating sequences and plays...
[23:35:39] INFO:   sequence_key: 11153/11155
[23:35:39] INFO:   play_key: 11153/11155
[23:35:39] INFO: Standardizing play_detail values...
[23:35:39] INFO:   Dropped 1 index columns (keys retained)
[23:35:39] INFO: Adding FK columns...
[23:35:39] INFO:   Added 9 FK columns
[23:35:39] INFO: Adding event_chain_key...
[23:35:39] INFO:   event_chain_key: 11155/11155
[23:35:39] INFO:   Removed 3 unused flag columns: ['event_index_flag', 'sequence_index_flag', 'play_index_flag']
[23:35:39] INFO:   Removed 3 duplicate columns: ['team', 'Type', 'play_detail2']
[23:35:40] INFO: 
Combined events: 11,155 rows, 98 cols, 4 games
[23:35:40] INFO:   player_id linked: 11130/11155
[23:35:40] INFO: Combined shifts: 399 rows, 4 games
[23:35:40] INFO: dim_player_role: 14 rows
[23:35:40] INFO: dim_position: 6 rows
[23:35:40] INFO: dim_zone: 3 rows
[23:35:40] INFO: dim_period: 5 rows
[23:35:40] INFO: dim_venue: 2 rows
[23:35:40] INFO: dim_event_type: using BLB_Tables data
[23:35:40] INFO: dim_event_detail: using BLB_Tables data
[23:35:40] INFO: dim_event_detail_2: using BLB_Tables data
[23:35:40] INFO: dim_success: 3 rows
[23:35:40] INFO: dim_shot_type: 6 rows
[23:35:40] INFO: dim_pass_type: 8 rows
[23:35:40] INFO: dim_zone_entry_type: 13 rows
[23:35:40] INFO: dim_zone_exit_type: 12 rows
[23:35:40] INFO: dim_stoppage_type: 4 rows
[23:35:40] INFO: dim_giveaway_type: 13 rows (6 bad, 7 neutral)
[23:35:40] INFO: dim_takeaway_type: 8 rows
[23:35:40] INFO: dim_play_detail: using BLB_Tables data
[23:35:40] INFO: dim_play_detail_2: using BLB_Tables data
[23:35:40] INFO: Creating fact_events...
[23:35:43] INFO:   fact_events: 5,823 rows, 53 cols
[23:35:43] INFO:   FKs: period_id=5823, event_type_id=5823, event_detail_id=3935
[23:35:43] INFO: Creating fact_tracking...
[23:35:43] INFO:   fact_tracking: 5,823 rows, 19 cols
[23:35:43] INFO: Creating fact_shifts...
[23:35:43] INFO:   fact_shifts: 399 rows
[23:35:43] INFO: Creating fact_shift_players...
[23:35:43] INFO:   fact_shift_players: 4,613 rows
[23:35:43] INFO:   player_id linked: 4609/4613
[23:35:43] INFO: Enhancing fact_event_players: 11155 rows, 98 cols
[23:35:43] INFO: Enhancing fact_events: 5823 rows, 53 cols
[23:35:43] INFO:   Adding shift_id FK (matching events to shifts)...
[23:35:43] WARN:     Shift time columns not found, skipping shift_id FK
[23:35:43] INFO:   Adding player_name...
[23:35:43] INFO:   Adding season_id...
[23:35:43] INFO:   Adding position_id...
[23:35:44] INFO:   Adding shot_type_id...
[23:35:44] INFO:   Adding zone_entry_type_id...
[23:35:44] INFO:   Adding zone_exit_type_id...
[23:35:44] INFO:   Adding stoppage_type_id...
[23:35:44] INFO:   Adding giveaway_type_id...
[23:35:44] INFO:   Adding takeaway_type_id...
[23:35:45] INFO:   Adding turnover_type_id (placeholder - linked in post-ETL)...
[23:35:45] INFO:   Adding pass_type_id...
[23:35:45] INFO:   Adding time_bucket_id...
[23:35:45] INFO:   Adding strength_id...
[23:35:45] INFO:   Adding player_rating...
[23:35:45] INFO:   Dropping: role_number, role_abrev, team_venue_abv...
[23:35:45] INFO:   ✓ fact_event_players: 11155 rows, 108 cols
[23:35:45] INFO:   Enhancing fact_events from tracking...
[23:35:45] INFO:   ✓ fact_events: 5823 rows, 67 cols
[23:35:45] INFO:   Fill rates:
[23:35:45] INFO:     player_name: 11130/11155 (99.8%)
[23:35:45] INFO:     season_id: 11155/11155 (100.0%)
[23:35:45] INFO:     position_id: 11130/11155 (99.8%)
[23:35:45] INFO:     shot_type_id: 932/11155 (8.4%)
[23:35:45] INFO:     zone_entry_type_id: 1327/11155 (11.9%)
[23:35:45] INFO:     zone_exit_type_id: 828/11155 (7.4%)
[23:35:45] INFO:     stoppage_type_id: 168/11155 (1.5%)
[23:35:45] INFO:     giveaway_type_id: 1015/11155 (9.1%)
[23:35:45] INFO:     takeaway_type_id: 279/11155 (2.5%)
[23:35:45] INFO:     turnover_type_id: 0/11155 (0.0%)
[23:35:45] INFO:     pass_type_id: 2155/11155 (19.3%)
[23:35:45] INFO:     time_bucket_id: 11150/11155 (100.0%)
[23:35:45] INFO:     strength_id: 11155/11155 (100.0%)
[23:35:45] INFO:     player_rating: 11130/11155 (99.8%)
[23:35:46] INFO: Enhancing fact_player_event_chains...
[23:35:46] INFO: Enhancing fact_tracking...
[23:35:46] INFO:   ✓ fact_tracking: 5823 rows, 22 cols
[23:35:46] INFO: Building fact_cycle_events with zone inference...
[23:35:46] INFO:   ✓ fact_cycle_events: 39 rows
[23:35:47] INFO:   ✓ Updated is_cycle flag: 508 tracking rows, 244 event rows
[23:35:47] INFO:   Done enhancing derived tables
[23:35:47] INFO: Enhancing 5823 events...
[23:35:47] INFO:   Adding context columns...
[23:35:52] INFO:     Context columns added: 43
[23:35:52] INFO:   ✓ fact_events: 5823 rows, 144 cols
[23:35:52] INFO:     Flags: rush=142, controlled_entry=338, carried_entry=266, sog=231
[23:35:53] INFO: Aggregating 5823 events into sequences...
[23:35:53] INFO:   ✓ fact_sequences: 521 rows, 38 cols
[23:35:53] INFO:     Goals: 16, Avg events/seq: 11.2
[23:35:54] INFO: Aggregating 5823 events into plays...
[23:35:57] INFO:   ✓ fact_plays: 2202 rows, 39 cols
[23:35:57] INFO:     Goals: 16, Shots: 375, Avg events/play: 2.6
[23:35:57] INFO:   ✓ dim_danger_level: 3 rows
[23:35:57] INFO:   ✓ fact_rushes: 142 rows
[23:35:57] INFO:   ✓ fact_breakouts: 476 rows
[23:35:57] INFO:   ✓ fact_zone_entries: 495 rows
[23:35:57] INFO:   ✓ fact_zone_exits: 476 rows
[23:35:57] INFO:   ✓ fact_scoring_chances_detailed: 247 rows
[23:35:57] INFO:   ✓ fact_high_danger_chances: 23 rows
[23:35:57] INFO:   ✓ fact_saves: 213 rows
[23:35:57] INFO:   ✓ fact_turnovers_detailed: 744 rows
[23:35:57] INFO:   ✓ fact_faceoffs: 169 rows
[23:35:57] INFO:   ✓ fact_penalties: 11 rows
[23:35:57] INFO: Enhancing 399 shifts...
[23:35:59] INFO:   Adding team ratings (excluding goalies)...
[23:35:59] INFO:   Team ratings: home_avg=4.03, away_avg=3.92, differential=0.11
[23:35:59] INFO:   Calculating game state (leading/trailing/tied)...
[23:35:59] INFO:   Game states: tied=227, home_leading=99, home_trailing=73
[23:36:01] INFO:   ✓ fact_shifts: 399 rows, 140 cols
[23:36:01] INFO:   ✓ Player IDs, plus/minus (5 types), shift stats added
[23:36:01] INFO: Enhancing 4613 shift-player records...
[23:36:01] INFO:   Source: fact_shifts has 140 columns
[23:36:01] INFO:   Pass 1: Pulling stats from fact_shifts...
[23:36:02] INFO:     Pulled 26 columns from fact_shifts
[23:36:02] INFO:   Pass 1B: Calculating logical shifts...
[23:36:02] INFO:     Logical shifts: max per player-game = 14, avg = 9.6
[23:36:02] INFO:   Pass 2: Adding player ratings and adjusted stats...
[23:36:02] INFO:   Pass 2B: Calculating adjusted stats...
[23:36:02] INFO:     Performance distribution: Over=1213, Expected=2164, Under=1236
[23:36:02] INFO:   ✓ fact_shift_players: 4613 rows, 89 columns
[23:36:02] INFO:   ✓ Enhanced from 9 to 89 columns (v19.00 fix)
[23:36:02] INFO: Building player game positions from 4613 shift-player records...
[23:36:02] INFO:   ✓ fact_player_game_position: 107 rows
[23:36:03] INFO:   ✓ Updated 10 positions in fact_gameroster from shift data
[23:36:03] INFO: 
[1] Table existence check:
[23:36:03] INFO:   ✓ dim_player: 337 rows
[23:36:03] INFO:   ✓ dim_team: 17 rows
[23:36:03] INFO:   ✓ dim_league: 2 rows
[23:36:03] INFO:   ✓ dim_season: 9 rows
[23:36:03] INFO:   ✓ dim_schedule: 572 rows
[23:36:03] INFO:   ✓ dim_player_role: 14 rows
[23:36:03] INFO:   ✓ dim_position: 6 rows
[23:36:03] INFO:   ✓ dim_zone: 3 rows
[23:36:03] INFO:   ✓ dim_period: 5 rows
[23:36:03] INFO:   ✓ dim_venue: 2 rows
[23:36:03] INFO:   ✓ fact_gameroster: 14,724 rows
[23:36:03] INFO:   ✓ fact_events: 5,823 rows
[23:36:03] INFO:   ✓ fact_event_players: 11,155 rows
[23:36:03] INFO:   ✓ fact_tracking: 5,823 rows
[23:36:03] INFO:   ✓ fact_shifts: 399 rows
[23:36:03] INFO:   ✓ fact_shift_players: 4,613 rows
[23:36:03] INFO:   ✓ fact_shifts: 399 rows
[23:36:03] INFO:   ✓ fact_draft: 160 rows
[23:36:03] INFO:   ✓ fact_registration: 190 rows
[23:36:03] INFO:   ✓ fact_leadership: 28 rows
[23:36:03] INFO: 
[2] Game coverage (tracking tables):
[23:36:03] INFO:   ✓ fact_events: all 4 games present
[23:36:03] INFO:   ✓ fact_shifts: all 4 games present
[23:36:03] INFO:   ✓ fact_shift_players: all 4 games present
[23:36:03] INFO: 
[3] Primary key integrity:
[23:36:03] INFO:   ✓ dim_player.player_id: P100001
[23:36:03] INFO:   ✓ dim_team.team_id: N10001
[23:36:03] INFO:   ✓ dim_league.league_id: N
[23:36:03] INFO:   ✓ dim_season.season_id: N20212022F
[23:36:03] INFO:   ✓ dim_schedule.game_id: 18619
[23:36:03] INFO:   ✓ fact_events.event_id: EV1896901496
[23:36:03] INFO:   ✓ fact_shifts.shift_id: SH1896900001
[23:36:03] INFO:   ✓ fact_shift_players.shift_player_id: SP1896900001P100001
[23:36:03] INFO: 
[4] Player ID linkage:
[23:36:04] INFO:   ✓ fact_event_players: 11,130/11,155 (99.8%)
[23:36:04] INFO:   ✓ fact_shift_players: 4,609/4,613 (99.9%)
[23:36:04] INFO:   ✓ fact_gameroster: 14,724/14,724 (100.0%)
[23:36:04] INFO: 
[5] No underscore columns check:
[23:36:04] INFO:   ✓ dim_play_detail: clean
[23:36:04] INFO:   ✓ dim_league: clean
[23:36:04] INFO:   ✓ dim_zone_entry_type: clean
[23:36:04] INFO:   ✓ dim_venue: clean
[23:36:04] INFO:   ✓ dim_schedule: clean
[23:36:04] INFO:   ✓ fact_plays: clean
[23:36:04] INFO:   ✓ dim_season: clean
[23:36:04] INFO:   ✓ dim_shot_type: clean
[23:36:04] INFO:   ✓ dim_randomnames: clean
[23:36:04] INFO:   ✓ dim_play_detail_2: clean
[23:36:04] INFO:   ✓ dim_event_detail_2: clean
[23:36:04] INFO:   ✓ fact_registration: clean
[23:36:04] INFO:   ✓ dim_situation: clean
[23:36:04] INFO:   ✓ dim_stoppage_type: clean
[23:36:04] INFO:   ✓ fact_high_danger_chances: clean
[23:36:04] INFO:   ✓ fact_leadership: clean
[23:36:04] INFO:   ✓ fact_turnovers_detailed: clean
[23:36:04] INFO:   ✓ fact_zone_exits: clean
[23:36:04] INFO:   ✓ dim_success: clean
[23:36:04] INFO:   ✓ dim_event_type: clean
[23:36:04] INFO:   ✓ fact_draft: clean
[23:36:04] INFO:   ✓ fact_shifts: clean
[23:36:04] INFO:   ✓ dim_zone: clean
[23:36:04] INFO:   ✓ fact_cycle_events: clean
[23:36:04] INFO:   ✓ dim_position: clean
[23:36:04] INFO:   ✓ fact_event_players: clean
[23:36:04] INFO:   ✓ fact_sequences: clean
[23:36:04] INFO:   ✓ dim_playerurlref: clean
[23:36:04] INFO:   ✓ dim_giveaway_type: clean
[23:36:04] INFO:   ✓ fact_zone_entries: clean
[23:36:04] INFO:   ✓ fact_gameroster: clean
[23:36:04] INFO:   ✓ dim_takeaway_type: clean
[23:36:04] INFO:   ✓ dim_shift_start_type: clean
[23:36:04] INFO:   ✓ fact_player_game_position: clean
[23:36:04] INFO:   ✓ dim_pass_type: clean
[23:36:04] INFO:   ✓ fact_saves: clean
[23:36:04] INFO:   ✓ fact_penalties: clean
[23:36:04] INFO:   ✓ dim_player: clean
[23:36:04] INFO:   ✓ dim_event_detail: clean
[23:36:04] INFO:   ✓ fact_scoring_chances_detailed: clean
[23:36:04] INFO:   ✓ dim_zone_exit_type: clean
[23:36:04] INFO:   ✓ fact_rushes: clean
[23:36:04] INFO:   ✓ dim_period: clean
[23:36:04] INFO:   ✓ dim_player_role: clean
[23:36:04] INFO:   ✓ fact_events: clean
[23:36:04] INFO:   ✓ fact_shift_players: clean
[23:36:04] INFO:   ✓ fact_faceoffs: clean
[23:36:04] INFO:   ✓ fact_breakouts: clean
[23:36:04] INFO:   ✓ dim_shift_stop_type: clean
[23:36:04] INFO:   ✓ dim_team: clean
[23:36:04] INFO:   ✓ dim_danger_level: clean
[23:36:04] INFO:   ✓ fact_tracking: clean
[23:36:04] INFO: 
[6] Referential integrity:
[23:36:04] INFO:   ✓ All event games exist in schedule
[23:36:05] INFO: Tables: 52
[23:36:05] INFO: Total rows: 51,360
[23:36:05] INFO: Warnings: 7
[23:36:05] INFO: Errors: 0
[23:36:05] INFO: Issues for review: 0
[23:36:05] INFO: 
✓ ALL VALIDATIONS PASSED