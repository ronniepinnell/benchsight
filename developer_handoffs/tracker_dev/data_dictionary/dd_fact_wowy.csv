column,type,nullable,description,source,formula,filter_context,tolerance,depends_on,used_by
wowy_key,VARCHAR(20),NO,Primary key,CALCULATED,f'WY{game_id}{pair_sequence:05d}',Per teammate pair per game,,game_id,
game_id,INT,NO,Game identifier,EXPLICIT,From source,,,,Joins
player_1_id,VARCHAR(10),NO,Primary player,DERIVED,From shifts analysis,,,fact_shifts_player,Analysis
player_2_id,VARCHAR(10),NO,Teammate,DERIVED,Same team player on ice together,Same team as player_1,,fact_shifts_player,Analysis
shifts_with,INT,NO,Shifts with player_2 on ice,CALCULATED,COUNT(shifts) WHERE p1 on ice AND p2 on ice AND same team,"Same team, both on ice",1-50,fact_shifts_player,"cf_with, etc."
shifts_without,INT,NO,Shifts without player_2 on ice,CALCULATED,COUNT(shifts) WHERE p1 on ice AND p2 NOT on ice,"p1 on ice, p2 not on ice",1-50,fact_shifts_player,"cf_without, etc."
cf_with,INT,NO,Corsi for when playing with teammate,CALCULATED,Shot attempts by team during shifts_with,Team shots during shifts_with,0-30,"fact_events_player, shifts_with",cf_pct_with
ca_with,INT,NO,Corsi against when playing with teammate,CALCULATED,Opponent shot attempts during shifts_with,Opponent shots during shifts_with,0-30,"fact_events_player, shifts_with",cf_pct_with
cf_without,INT,NO,Corsi for when playing without teammate,CALCULATED,Shot attempts by team during shifts_without,Team shots during shifts_without,0-30,"fact_events_player, shifts_without",cf_pct_without
ca_without,INT,NO,Corsi against when playing without teammate,CALCULATED,Opponent shot attempts during shifts_without,Opponent shots during shifts_without,0-30,"fact_events_player, shifts_without",cf_pct_without
cf_pct_with,"DECIMAL(5,2)",YES,CF% when playing together,CALCULATED,"ROUND(cf_with / (cf_with + ca_with) * 100, 1)",Same row,0-100%,"cf_with, ca_with",cf_pct_diff
cf_pct_without,"DECIMAL(5,2)",YES,CF% when playing apart,CALCULATED,"ROUND(cf_without / (cf_without + ca_without) * 100, 1)",Same row,0-100%,"cf_without, ca_without",cf_pct_diff
cf_pct_diff,"DECIMAL(5,2)",YES,CF% difference (with - without) - teammate impact,CALCULATED,cf_pct_with - cf_pct_without,Same row,"-50 to +50, typical -15 to +15","cf_pct_with, cf_pct_without",Teammate impact analysis
