column,type,nullable,description,source,formula,filter_context,tolerance,depends_on,used_by
player_game_key,VARCHAR(20),NO,Primary key,CALCULATED,f'PG{game_id}{player_sequence:05d}',Per player per game,,game_id,
game_id,INT,NO,Game identifier,EXPLICIT,From source data,,,,All aggregations
player_id,VARCHAR(10),NO,Player identifier,LOOKUP,From fact_gameroster,,,fact_gameroster,All player stats
player_name,VARCHAR(100),YES,Player full name,LOOKUP,fact_gameroster.player_full_name,,,player_id,Display
team_name,VARCHAR(50),YES,Team name,LOOKUP,fact_gameroster.team_name,,,"player_id, game_id",Team aggregations
goals,INT,NO,Goals scored,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Goal"" 
  - player_role = ""event_team_player_1""
  - player_id matches","player_id, game_id, player_role=event_team_player_1, event_type=Goal","0-5 per game, FLAG if >5","fact_events_player.event_type, player_role","points, shooting_pct, team goals"
assists,INT,NO,Total assists (primary + secondary),CALCULATED,"COUNT(fact_events_player) WHERE:
  - play_detail1 CONTAINS ""Assist"" (AssistPrimary OR AssistSecondary)
  - player_id matches","player_id, game_id, play_detail1 LIKE ""%Assist%""","0-5 per game, FLAG if >5",fact_events_player.play_detail1,points
points,INT,NO,Total points,CALCULATED,goals + assists,Same row,0-8 per game,"goals, assists",points_per_60
shots,INT,NO,Shot attempts (Corsi - all shot attempts),CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Shot""
  - player_role = ""event_team_player_1""","player_id, game_id, player_role=event_team_player_1, event_type=Shot","0-30 per player, FLAG if >30",fact_events_player,"shooting_pct, cf, team shots"
shots_on_goal,INT,NO,Shots on goal (reached goalie),CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Shot""
  - player_role = ""event_team_player_1""
  - event_detail IN (""Shot_OnNetSaved"", ""Shot_Goal"", ""Shot_TippedOnNetSaved"", ""Shot_DeflectedOnNetSaved"", ""Shot_OnNetTippedGoal"")","player_id, game_id, player_role=event_team_player_1, event_detail filter for on-net",0-20 per player,fact_events_player.event_detail,shooting_pct
shooting_pct,"DECIMAL(5,2)",YES,Shooting percentage,CALCULATED,"ROUND(goals / shots_on_goal * 100, 1) IF shots_on_goal > 0 ELSE 0",Same row,"0-100%, typical 5-25%, FLAG if >50%","goals, shots_on_goal",
shift_count,INT,NO,Raw shift count (includes micro-shifts from line changes),CALCULATED,COUNT(fact_shifts_player) WHERE player_id matches,"player_id, game_id","20-100, WARNING if outside",fact_shifts_player,
logical_shifts,INT,NO,Logical shift count (continuous on-ice periods),CALCULATED,"COUNT of continuous on-ice periods:
  1. Sort shifts by start time
  2. Group consecutive shifts with <10sec gap
  3. Count resulting groups","player_id, game_id, gap threshold <10 seconds","5-20, typical 10-14, FLAG if <5 or >20",fact_shifts_player sorted by time,"avg_shift, points_per_shift"
toi_seconds,INT,NO,Time on ice in seconds,CALCULATED,SUM(shift_duration_seconds) for all player shifts,"player_id, game_id","300-1500 seconds, FLAG if outside",fact_shifts_player.shift_duration_seconds,"toi_formatted, per_60 calculations, avg_shift"
avg_shift,"DECIMAL(6,2)",YES,Average shift length in seconds,CALCULATED,toi_seconds / logical_shifts,Same row,"30-180 seconds, FLAG if outside","toi_seconds, logical_shifts",
fo_wins,INT,NO,Faceoff wins,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Faceoff""
  - player_role = ""event_team_player_1"" (event_team_player_1 = WINNER)","player_id, game_id, event_type=Faceoff, player_role=event_team_player_1",0-25 per player,fact_events_player,"fo_pct, team fo_wins"
fo_losses,INT,NO,Faceoff losses,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Faceoff""
  - player_role = ""opp_team_player_1"" (opp_team_player_1 = LOSER)","player_id, game_id, event_type=Faceoff, player_role=opp_team_player_1",0-25 per player,fact_events_player,"fo_pct, team fo_losses"
fo_pct,"DECIMAL(5,2)",YES,Faceoff win percentage,CALCULATED,"ROUND(fo_wins / (fo_wins + fo_losses) * 100, 1) IF (fo_wins + fo_losses) > 0 ELSE NULL",Same row,"0-100%, typical 40-60%, FLAG if outside","fo_wins, fo_losses",
zone_entries,INT,NO,Total zone entries,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Zone_Entry_Exit""
  - event_detail CONTAINS ""Entry""
  - player_role = ""event_team_player_1""","player_id, game_id, player_role=event_team_player_1, event_detail filter","0-20 per player, FLAG if >20",fact_events_player.event_detail,zone_entry_control_pct
zone_entry_carry,INT,NO,Zone entries with puck carry (controlled rush),CALCULATED,"COUNT WHERE event_detail_2 = ""ZoneEntry-Rush""",Same as zone_entries + event_detail_2 filter,0-15,fact_events_player.event_detail_2,zone_entries_controlled
zone_entry_pass,INT,NO,Zone entries via pass,CALCULATED,"COUNT WHERE event_detail_2 = ""ZoneEntry-Pass""",Same as zone_entries + event_detail_2 filter,0-10,fact_events_player.event_detail_2,zone_entries_controlled
zone_entry_dump,INT,NO,Zone entries via dump/chip (uncontrolled),CALCULATED,"COUNT WHERE event_detail_2 IN (""ZoneEntry-DumpIn"", ""ZoneEntry-Chip"")",Same as zone_entries + event_detail_2 filter,0-10,fact_events_player.event_detail_2,
zone_entries_controlled,INT,NO,Controlled zone entries (carry + pass),CALCULATED,zone_entry_carry + zone_entry_pass,Same row,0-20,"zone_entry_carry, zone_entry_pass",zone_entry_control_pct
zone_entry_control_pct,"DECIMAL(5,2)",YES,Zone entry control percentage,CALCULATED,"ROUND(zone_entries_controlled / zone_entries * 100, 1) IF zone_entries > 0 ELSE NULL",Same row,"0-100%, typical 30-70%, FLAG if outside 0-100","zone_entries_controlled, zone_entries",
pass_attempts,INT,NO,Pass attempts,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Pass""
  - player_role = ""event_team_player_1""","player_id, game_id, player_role=event_team_player_1, event_type=Pass",10-80 per player,fact_events_player,pass_pct
pass_completed,INT,NO,Completed passes,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Pass""
  - player_role = ""event_team_player_1""
  - event_successful = ""s""","Same as pass_attempts + event_successful=""s""",5-70 per player,fact_events_player.event_successful,pass_pct
pass_pct,"DECIMAL(5,2)",YES,Pass completion percentage,CALCULATED,"ROUND(pass_completed / pass_attempts * 100, 1) IF pass_attempts > 0 ELSE NULL",Same row,"0-100%, typical 50-80%, FLAG if 0% with >10 attempts","pass_completed, pass_attempts",
giveaways,INT,NO,Giveaways (lost puck possession),CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Turnover""
  - event_detail CONTAINS ""Giveaway""
  - player_role = ""event_team_player_1""","player_id, game_id, player_role=event_team_player_1, event_detail filter",0-15 per player,fact_events_player.event_detail,turnover_diff
takeaways,INT,NO,Takeaways (gained puck possession),CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Turnover""
  - event_detail CONTAINS ""Takeaway""
  - player_role = ""event_team_player_1""","player_id, game_id, player_role=event_team_player_1, event_detail filter",0-10 per player,fact_events_player.event_detail,turnover_diff
