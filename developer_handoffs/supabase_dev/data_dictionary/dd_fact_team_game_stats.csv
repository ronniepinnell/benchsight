column,type,nullable,description,source,formula,filter_context,tolerance,depends_on,used_by
team_game_key,VARCHAR(20),NO,Primary key,CALCULATED,f'TG{game_id}{team_sequence:05d}',Per team per game (2 rows per game),,game_id,
game_id,INT,NO,Game identifier,EXPLICIT,From source data,,,,Joins
team_id,VARCHAR(10),NO,Team identifier,LOOKUP,From fact_gameroster.team_id,,,fact_gameroster,dim_team join
team_name,VARCHAR(50),NO,Team name,LOOKUP,fact_gameroster.team_name,,,team_id,"Display, event filtering"
venue,VARCHAR(10),NO,Home or Away,LOOKUP,fact_gameroster.team_venue,,Home or Away,fact_gameroster,Home/Away splits
goals,INT,NO,Team goals scored,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Goal""
  - player_team = team_name
  - player_role = ""event_team_player_1""","game_id, team_name, player_role=event_team_player_1","0-15, VALIDATE vs dim_schedule (official score)",fact_events_player,"shooting_pct, win/loss"
shots,INT,NO,Team shot attempts (CORSI FOR),CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Shot""
  - player_team = team_name
  - player_role = ""event_team_player_1""","game_id, team_name, player_role=event_team_player_1, event_type=Shot","40-100 per game, typical 50-70",fact_events_player,"corsi_for, shooting_pct"
sog,INT,NO,Team shots on goal,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Shot""
  - player_team = team_name  
  - player_role = ""event_team_player_1""
  - event_detail IN (""Shot_OnNetSaved"", ""Shot_Goal"", ""Shot_TippedOnNetSaved"", ""Shot_DeflectedOnNetSaved"")",Same as shots + event_detail filter for on-net shots,"20-50 per game, typical 25-40",fact_events_player.event_detail,shooting_pct
fo_wins,INT,NO,Team faceoff wins,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Faceoff""
  - player_team = team_name
  - player_role = ""event_team_player_1"" (winner)","game_id, team_name, player_role=event_team_player_1, event_type=Faceoff",15-40 per game,fact_events_player,fo_pct
fo_losses,INT,NO,Team faceoff losses,CALCULATED,Total game faceoffs - fo_wins (since faceoffs are symmetric),"Same game, opposite team wins","15-40 per game, fo_wins + fo_losses = fo_total","fo_wins, total faceoffs",fo_pct
fo_total,INT,NO,Total faceoffs in game,CALCULATED,fo_wins + fo_losses,Same row,"35-60 per game, same for both teams","fo_wins, fo_losses",fo_pct
fo_pct,"DECIMAL(5,2)",NO,Faceoff win percentage,CALCULATED,"ROUND(fo_wins / fo_total * 100, 1)",Same row,"0-100%, typical 40-60%, sum of both teams = 100%","fo_wins, fo_total",
pass_attempts,INT,NO,Team pass attempts,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Pass""
  - player_team = team_name
  - player_role = ""event_team_player_1""","game_id, team_name, player_role=event_team_player_1",100-300 per game,fact_events_player,pass_pct
pass_completed,INT,NO,Team completed passes,CALCULATED,"Same as pass_attempts + event_successful = ""s""",Same as pass_attempts + event_successful filter,"50-250 per game, <=pass_attempts",fact_events_player.event_successful,pass_pct
pass_pct,"DECIMAL(5,2)",NO,Team pass completion percentage,CALCULATED,"ROUND(pass_completed / pass_attempts * 100, 1) IF pass_attempts > 0 ELSE 0",Same row,"0-100%, typical 55-75%, FLAG if 0% with attempts>50","pass_completed, pass_attempts",
giveaways,INT,NO,Team giveaways,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Turnover""
  - event_detail CONTAINS ""Giveaway""
  - player_team = team_name
  - player_role = ""event_team_player_1""","game_id, team_name, player_role=event_team_player_1, event_detail filter",30-100 per game,fact_events_player.event_detail,turnover_diff
takeaways,INT,NO,Team takeaways,CALCULATED,"COUNT(fact_events_player) WHERE:
  - event_type = ""Turnover""
  - event_detail CONTAINS ""Takeaway""
  - player_team = team_name
  - player_role = ""event_team_player_1""","game_id, team_name, player_role=event_team_player_1, event_detail filter",10-40 per game,fact_events_player.event_detail,turnover_diff
shooting_pct,"DECIMAL(5,2)",NO,Team shooting percentage,CALCULATED,"ROUND(goals / sog * 100, 1) IF sog > 0 ELSE 0",Same row,"0-100%, typical 5-15%","goals, sog",
